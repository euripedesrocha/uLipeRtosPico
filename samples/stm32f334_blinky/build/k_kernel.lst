ARM GAS  /tmp/cc4fe6my.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"k_kernel.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.k_idle_thread,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv4-sp-d16
  24              	k_idle_thread:
  25              	.LFB20:
  26              		.file 1 "../../picokernel/k_kernel.c"
   1:../../picokernel/k_kernel.c **** /**
   2:../../picokernel/k_kernel.c ****  * 							ULIPE RTOS PICO
   3:../../picokernel/k_kernel.c ****  *
   4:../../picokernel/k_kernel.c ****  *  @file k_kernel.c
   5:../../picokernel/k_kernel.c ****  *
   6:../../picokernel/k_kernel.c ****  *  @brief multithreading core file
   7:../../picokernel/k_kernel.c ****  *
   8:../../picokernel/k_kernel.c ****  */
   9:../../picokernel/k_kernel.c **** 
  10:../../picokernel/k_kernel.c **** #include "ulipe_rtos_pico.h"
  11:../../picokernel/k_kernel.c **** 
  12:../../picokernel/k_kernel.c **** /**static variables **/
  13:../../picokernel/k_kernel.c **** THREAD_CONTROL_BLOCK_DECLARE(idle_thread, 64, 0);
  14:../../picokernel/k_kernel.c **** 
  15:../../picokernel/k_kernel.c **** 
  16:../../picokernel/k_kernel.c **** 
  17:../../picokernel/k_kernel.c **** static k_work_list_t k_rdy_list;
  18:../../picokernel/k_kernel.c **** static k_list_t k_timed_list;
  19:../../picokernel/k_kernel.c **** 
  20:../../picokernel/k_kernel.c **** static bool k_configured;
  21:../../picokernel/k_kernel.c **** static archtype_t irq_counter;
  22:../../picokernel/k_kernel.c **** uint32_t irq_lock_nest;
  23:../../picokernel/k_kernel.c **** 
  24:../../picokernel/k_kernel.c **** /** public variables **/
  25:../../picokernel/k_kernel.c **** bool k_running = false;
  26:../../picokernel/k_kernel.c **** tcb_t *k_current_task;
  27:../../picokernel/k_kernel.c **** tcb_t *k_high_prio_task;
  28:../../picokernel/k_kernel.c **** archtype_t irq_nesting = 0;
  29:../../picokernel/k_kernel.c **** 
  30:../../picokernel/k_kernel.c **** static k_wakeup_info_t wu_info;
  31:../../picokernel/k_kernel.c **** 
  32:../../picokernel/k_kernel.c **** 
ARM GAS  /tmp/cc4fe6my.s 			page 2


  33:../../picokernel/k_kernel.c **** #if((K_ENABLE_TICKER > 0) || (K_ENABLE_TIMERS > 0))
  34:../../picokernel/k_kernel.c **** extern tcb_t timer_tcb;
  35:../../picokernel/k_kernel.c **** extern void timer_dispatcher(void *args);
  36:../../picokernel/k_kernel.c **** #endif
  37:../../picokernel/k_kernel.c **** 
  38:../../picokernel/k_kernel.c **** /** private functions **/
  39:../../picokernel/k_kernel.c **** 
  40:../../picokernel/k_kernel.c **** 
  41:../../picokernel/k_kernel.c **** 
  42:../../picokernel/k_kernel.c **** /**
  43:../../picokernel/k_kernel.c ****  *  @fn k_idle_thread()
  44:../../picokernel/k_kernel.c ****  *  @brief idle thread to be executed when no other thread are ready to run
  45:../../picokernel/k_kernel.c ****  *  @param
  46:../../picokernel/k_kernel.c ****  *  @return
  47:../../picokernel/k_kernel.c ****  */
  48:../../picokernel/k_kernel.c **** static void k_idle_thread(void *kernel_info)
  49:../../picokernel/k_kernel.c **** {
  27              		.loc 1 49 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              	.LVL0:
  32              	.LBB71:
  33              	.LBB72:
  34              		.file 2 "../../../uLipeRtosPico/ulipe_rtos_pico.h"
   1:../../../uLipeRtosPico/ulipe_rtos_pico.h **** /**
   2:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  * 							ULIPE RTOS PICO
   3:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *
   4:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *  @file ulipe_rtos_pico.h
   5:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *
   6:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *  @brief this file is treated as a master file
   7:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *
   8:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *
   9:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  */
  10:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #ifndef __ULIPE_RTOS_PICO_H
  11:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #define __ULIPE_RTOS_PICO_H
  12:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  13:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  14:../../../uLipeRtosPico/ulipe_rtos_pico.h **** /* include all the kernel header files actig as a glue module */
  15:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include <stdint.h>
  16:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include <stdbool.h>
  17:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include <stddef.h>
  18:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include <string.h>
  19:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  20:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "picokernel/inc/k_list.h"
  21:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "ulipe_rtos_kconfig.h"
  22:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  23:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #ifndef __ULIPE_RTOS_KCONFIG_H
  24:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	#error "No config file found, loading default setings"
  25:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #endif
  26:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  27:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  28:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  29:../../../uLipeRtosPico/ulipe_rtos_pico.h **** /* ulipe rtos pico status codes */
  30:../../../uLipeRtosPico/ulipe_rtos_pico.h **** typedef enum {
  31:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	/* general status */
  32:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_status_ok = 0,
ARM GAS  /tmp/cc4fe6my.s 			page 3


  33:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_status_error,
  34:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_status_invalid_param,
  35:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_status_sched_locked,
  36:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_status_illegal_from_isr,
  37:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  38:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	/* threading status */
  39:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_thread_rdy,
  40:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_thread_del,
  41:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_thread_blk,
  42:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_thread_susp,
  43:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  44:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	/* semaphore status */
  45:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_sema_not_available,
  46:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_sema_illegal_use_celling,
  47:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_mutex_already_available,
  48:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  49:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	/* queue status */
  50:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_queue_empty,
  51:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_queue_full,
  52:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  53:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	/* wqueue status */
  54:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_wqueue_already_exists,
  55:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  56:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	/* timer status */
  57:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_timer_expired,
  58:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_timer_running,
  59:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_timer_stopped,
  60:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_timer_busy,
  61:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  62:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  63:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	/* kernel configuration */
  64:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	k_not_available_with_current_config,
  65:../../../uLipeRtosPico/ulipe_rtos_pico.h **** }k_status_t;
  66:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  67:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  68:../../../uLipeRtosPico/ulipe_rtos_pico.h **** /**
  69:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *  @fn template()
  70:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *  @brief
  71:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *  @param
  72:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  *  @return
  73:../../../uLipeRtosPico/ulipe_rtos_pico.h ****  */
  74:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  75:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  76:../../../uLipeRtosPico/ulipe_rtos_pico.h **** /* resolves the arch dependend memory size */
  77:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #if	(K_ARCH_MEM_WIDTH_BYTE > 0)
  78:../../../uLipeRtosPico/ulipe_rtos_pico.h **** typedef uint8_t archtype_t;
  79:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #elif(K_ARCH_MEM_WIDTH_HALFWORD > 0)
  80:../../../uLipeRtosPico/ulipe_rtos_pico.h **** typedef uint16_t archtype_t;
  81:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #elif (K_ARCH_MEM_WIDTH_WORD > 0)
  82:../../../uLipeRtosPico/ulipe_rtos_pico.h **** typedef uint32_t archtype_t;
  83:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #elif (K_ARCH_MEM_WIDTH_DWORD > 0)
  84:../../../uLipeRtosPico/ulipe_rtos_pico.h **** typedef uint64_t archtype_t;
  85:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #else
  86:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #endif
  87:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  88:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  89:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #if(K_ENABLE_DYNAMIC_ALLOCATOR > 0)
ARM GAS  /tmp/cc4fe6my.s 			page 4


  90:../../../uLipeRtosPico/ulipe_rtos_pico.h **** //#error "FATAL: Dynamic allocator is under development, please use memory pool instead!"
  91:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #ifndef K_HEAP_SIZE
  92:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #define K_HEAP_SIZE 1024
  93:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #endif
  94:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #endif
  95:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
  96:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #if(K_ENABLE_WORKQUEUES > 0)
  97:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #ifndef K_WQUEUES_STACK_SIZE
  98:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #define K_WQUEUES_STACK_SIZE 128
  99:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #endif
 100:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #endif
 101:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
 102:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #if(K_ENABLE_TICKLESS_IDLE > 0)
 103:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #ifndef K_MAX_LOW_POWER_PERIOD
 104:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #define K_MAX_LOW_POWER_PERIOD	100
 105:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #endif
 106:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
 107:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #define K_HW_TIMER_COUNTS_PER_TICK (K_MACHINE_CLOCK / K_TICKER_RATE)
 108:../../../uLipeRtosPico/ulipe_rtos_pico.h **** extern void user_lowpower_entry(void *arg);
 109:../../../uLipeRtosPico/ulipe_rtos_pico.h **** extern void user_lowpower_exit(void *arg);
 110:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #endif
 111:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
 112:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_thread.h"
 113:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_port.h"
 114:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_kernel.h"
 115:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_message.h"
 116:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_raw_timer.h"
 117:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_sema.h"
 118:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_mutex.h"
 119:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_memp.h"
 120:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_mem_dyn.h"
 121:../../../uLipeRtosPico/ulipe_rtos_pico.h **** #include "include/picokernel/k_wqueue.h"
 122:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
 123:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
 124:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 
 125:../../../uLipeRtosPico/ulipe_rtos_pico.h **** /** assertion mechanism */
 126:../../../uLipeRtosPico/ulipe_rtos_pico.h **** static inline void ulipe_assert(bool x)
 127:../../../uLipeRtosPico/ulipe_rtos_pico.h **** {
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 	if(!x){
  35              		.loc 2 128 0
  36 0000 00B1     		cbz	r0, .L7
  37              	.L2:
  38 0002 FEE7     		b	.L2
  39              	.L7:
  40              	.LBE72:
  41              	.LBE71:
  42              		.loc 1 49 0
  43 0004 08B5     		push	{r3, lr}
  44              	.LCFI0:
  45              		.cfi_def_cfa_offset 8
  46              		.cfi_offset 3, -8
  47              		.cfi_offset 14, -4
  48              	.LBB74:
  49              	.LBB73:
 129:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
  50              		.loc 2 129 0
  51 0006 FFF7FEFF 		bl	port_set_break
ARM GAS  /tmp/cc4fe6my.s 			page 5


  52              	.LVL1:
  53              	.L3:
  54 000a FEE7     		b	.L3
  55              	.LBE73:
  56              	.LBE74:
  57              		.cfi_endproc
  58              	.LFE20:
  60              		.section	.text.k_sched,"ax",%progbits
  61              		.align	1
  62              		.syntax unified
  63              		.thumb
  64              		.thumb_func
  65              		.fpu fpv4-sp-d16
  67              	k_sched:
  68              	.LFB21:
  50:../../picokernel/k_kernel.c **** 	k_wakeup_info_t *info = (k_wakeup_info_t *)kernel_info;
  51:../../picokernel/k_kernel.c **** 	ulipe_assert(info != NULL);
  52:../../picokernel/k_kernel.c **** 
  53:../../picokernel/k_kernel.c **** 
  54:../../picokernel/k_kernel.c **** 	for(;;) {
  55:../../picokernel/k_kernel.c **** #if (K_ENABLE_TICKLESS_IDLE > 0)
  56:../../picokernel/k_kernel.c **** 		/* kernel can sleep ? */
  57:../../picokernel/k_kernel.c **** 		if((info->next_thread_wake == NULL) && (info->next_timer == NULL)) {
  58:../../picokernel/k_kernel.c **** 			/* simplest case, we need only to enter in sleep for user defined time
  59:../../picokernel/k_kernel.c **** 			 * the tasks sleep for defined time is future implementation
  60:../../picokernel/k_kernel.c **** 			 */
  61:../../picokernel/k_kernel.c **** 
  62:../../picokernel/k_kernel.c **** 
  63:../../picokernel/k_kernel.c **** 
  64:../../picokernel/k_kernel.c **** 		}
  65:../../picokernel/k_kernel.c **** 
  66:../../picokernel/k_kernel.c **** #else
  67:../../picokernel/k_kernel.c **** 		(void)info;
  68:../../picokernel/k_kernel.c **** #endif
  69:../../picokernel/k_kernel.c **** 	}
  70:../../picokernel/k_kernel.c **** }
  71:../../picokernel/k_kernel.c **** 
  72:../../picokernel/k_kernel.c **** /**
  73:../../picokernel/k_kernel.c ****  *  @fn k_sched()
  74:../../picokernel/k_kernel.c ****  *  @brief gets the highest priority and most recet task to run
  75:../../picokernel/k_kernel.c ****  *  @param
  76:../../picokernel/k_kernel.c ****  *  @return
  77:../../picokernel/k_kernel.c ****  */
  78:../../picokernel/k_kernel.c **** static tcb_t *k_sched(k_work_list_t *l)
  79:../../picokernel/k_kernel.c **** {
  69              		.loc 1 79 0
  70              		.cfi_startproc
  71              		@ args = 0, pretend = 0, frame = 0
  72              		@ frame_needed = 0, uses_anonymous_args = 0
  73              	.LVL2:
  74 0000 10B5     		push	{r4, lr}
  75              	.LCFI1:
  76              		.cfi_def_cfa_offset 8
  77              		.cfi_offset 4, -8
  78              		.cfi_offset 14, -4
  79 0002 0446     		mov	r4, r0
  80              	.LVL3:
ARM GAS  /tmp/cc4fe6my.s 			page 6


  80:../../picokernel/k_kernel.c **** 	tcb_t *ret = &idle_thread;
  81:../../picokernel/k_kernel.c **** 	k_list_t *head;
  82:../../picokernel/k_kernel.c **** 
  83:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
  84:../../picokernel/k_kernel.c **** 	if(k_running) {
  81              		.loc 1 84 0
  82 0004 154B     		ldr	r3, .L22
  83 0006 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  84 0008 5BB1     		cbz	r3, .L9
  85:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
  85              		.loc 1 85 0
  86 000a 154B     		ldr	r3, .L22+4
  87 000c 1A68     		ldr	r2, [r3]
  88 000e 1368     		ldr	r3, [r2]
  89 0010 5168     		ldr	r1, [r2, #4]
  90 0012 5B1A     		subs	r3, r3, r1
  91 0014 9B10     		asrs	r3, r3, #2
  92 0016 9360     		str	r3, [r2, #8]
  86:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
  87:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
  93              		.loc 1 87 0
  94 0018 1269     		ldr	r2, [r2, #16]
  95 001a 9200     		lsls	r2, r2, #2
  96              	.LVL4:
  97              	.LBB75:
  98              	.LBB76:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
  99              		.loc 2 128 0
 100 001c B2EB830F 		cmp	r2, r3, lsl #2
 101 0020 04D3     		bcc	.L18
 102              	.LVL5:
 103              	.L9:
 104              	.LBE76:
 105              	.LBE75:
 106              	.LBB78:
 107              	.LBB79:
 108 0022 34B1     		cbz	r4, .L19
 109              	.LVL6:
 110              	.LBE79:
 111              	.LBE78:
  88:../../picokernel/k_kernel.c **** 	}
  89:../../picokernel/k_kernel.c **** #endif
  90:../../picokernel/k_kernel.c **** 
  91:../../picokernel/k_kernel.c **** 
  92:../../picokernel/k_kernel.c **** 
  93:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(l != NULL);
  94:../../picokernel/k_kernel.c **** 
  95:../../picokernel/k_kernel.c **** 	/* no tasks ready, just hint to kernel to load the idle task */
  96:../../picokernel/k_kernel.c **** 	if(!l->bitmap)
 112              		.loc 1 96 0
 113 0024 2068     		ldr	r0, [r4]
 114              	.LVL7:
 115 0026 38B9     		cbnz	r0, .L20
  80:../../picokernel/k_kernel.c **** 	k_list_t *head;
 116              		.loc 1 80 0
 117 0028 0E48     		ldr	r0, .L22+8
 118 002a 10BD     		pop	{r4, pc}
ARM GAS  /tmp/cc4fe6my.s 			page 7


 119              	.LVL8:
 120              	.L18:
 121              	.LBB81:
 122              	.LBB77:
 123              		.loc 2 129 0
 124 002c FFF7FEFF 		bl	port_set_break
 125              	.LVL9:
 126              	.L10:
 127 0030 FEE7     		b	.L10
 128              	.LVL10:
 129              	.L19:
 130              	.LBE77:
 131              	.LBE81:
 132              	.LBB82:
 133              	.LBB80:
 134 0032 FFF7FEFF 		bl	port_set_break
 135              	.LVL11:
 136              	.L12:
 137 0036 FEE7     		b	.L12
 138              	.LVL12:
 139              	.L20:
 140              	.LBE80:
 141              	.LBE82:
  97:../../picokernel/k_kernel.c **** 		goto cleanup;
  98:../../picokernel/k_kernel.c **** 
  99:../../picokernel/k_kernel.c **** 	/*
 100:../../picokernel/k_kernel.c **** 	 * The scheduling alghoritm uses a classical multilevel
 101:../../picokernel/k_kernel.c **** 	 * fifo ensuring a O(1) time complexity, the way to obtain the highest priority and first in
 102:../../picokernel/k_kernel.c **** 	 * task is performing a bit search on priority bitmap, since the
 103:../../picokernel/k_kernel.c **** 	 * priority levels is 4 + some sys priority only a simple
 104:../../picokernel/k_kernel.c **** 	 * lead zero table perform this action, with the prio obtained we
 105:../../picokernel/k_kernel.c **** 	 * get the head of the list indexed to this prio and
 106:../../picokernel/k_kernel.c **** 	 * finally access the tcb
 107:../../picokernel/k_kernel.c **** 	 */
 108:../../picokernel/k_kernel.c **** 	uint8_t prio = (K_PRIORITY_LEVELS - 1) - port_bit_fs_scan(l->bitmap);
 142              		.loc 1 108 0
 143 0038 FFF7FEFF 		bl	port_bit_fs_scan
 144              	.LVL13:
 145 003c C0F11F03 		rsb	r3, r0, #31
 146 0040 DBB2     		uxtb	r3, r3
 147              	.LVL14:
 109:../../picokernel/k_kernel.c **** 	
 110:../../picokernel/k_kernel.c **** 	head = sys_dlist_peek_head(&l->list_head[prio]);
 148              		.loc 1 110 0
 149 0042 04EBC304 		add	r4, r4, r3, lsl #3
 150              	.LVL15:
 151 0046 221D     		adds	r2, r4, #4
 152              	.LVL16:
 153              	.LBB83:
 154              	.LBB84:
 155              	.LBB85:
 156              	.LBB86:
 157              		.file 3 "../../../uLipeRtosPico/picokernel/inc/k_list.h"
   1:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
   2:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * 							ULIPE RTOS PICO
   3:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
   4:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *  @file k_list.h
ARM GAS  /tmp/cc4fe6my.s 			page 8


   5:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
   6:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *  @brief inline list implementantion core header file
   7:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
   8:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
   9:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
  10:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #ifndef __K_LIST_H
  11:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define __K_LIST_H
  12:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  13:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #include <stddef.h>
  14:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  15:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /*
  16:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Copyright (c) 2013-2015 Wind River Systems, Inc.
  17:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  18:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * SPDX-License-Identifier: Apache-2.0
  19:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
  20:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  21:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
  22:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @file
  23:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Doubly-linked list inline implementation
  24:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  25:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Doubly-linked list implementation.
  26:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  27:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * The lists are expected to be initialized such that both the head and tail
  28:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * pointers point to the list itself.  Initializing the lists in such a fashion
  29:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * simplifies the adding and removing of nodes to/from the list.
  30:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
  31:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  32:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  33:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  34:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /* classical container of to resolve list elements insert and remotion */
  35:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define CONTAINER_OF(ptr, type, field) ((type *)(((char *)(ptr)) - offsetof(type, field)))
  36:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  37:../../../uLipeRtosPico/picokernel/inc/k_list.h **** struct _dnode {
  38:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	union {
  39:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		struct _dnode *head; /* ptr to head of list (sys_dlist_t) */
  40:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		struct _dnode *next; /* ptr to next node    (sys_dnode_t) */
  41:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	};
  42:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	union {
  43:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		struct _dnode *tail; /* ptr to tail of list (sys_dlist_t) */
  44:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		struct _dnode *prev; /* ptr to previous node (sys_dnode_t) */
  45:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	};
  46:../../../uLipeRtosPico/picokernel/inc/k_list.h **** };
  47:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  48:../../../uLipeRtosPico/picokernel/inc/k_list.h **** typedef struct _dnode sys_dlist_t;
  49:../../../uLipeRtosPico/picokernel/inc/k_list.h **** typedef struct _dnode sys_dnode_t;
  50:../../../uLipeRtosPico/picokernel/inc/k_list.h **** typedef struct _dnode k_list_t;
  51:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  52:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  53:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
  54:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Provide the primitive to iterate on a list
  55:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Note: the loop is unsafe and thus __dn should not be removed
  56:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  57:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * User _MUST_ add the loop statement curly braces enclosing its own code:
  58:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  59:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     SYS_DLIST_FOR_EACH_NODE(l, n) {
  60:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *         <user code>
  61:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     }
ARM GAS  /tmp/cc4fe6my.s 			page 9


  62:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  63:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dl A pointer on a sys_dlist_t to iterate on
  64:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dn A sys_dnode_t pointer to peek each node of the list
  65:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
  66:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_FOR_EACH_NODE(__dl, __dn)				\
  67:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	for (__dn = sys_dlist_peek_head(__dl); __dn;			\
  68:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	     __dn = sys_dlist_peek_next(__dl, __dn))
  69:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  70:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
  71:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Provide the primitive to iterate on a list, from a node in the list
  72:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Note: the loop is unsafe and thus __dn should not be removed
  73:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  74:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * User _MUST_ add the loop statement curly braces enclosing its own code:
  75:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  76:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     SYS_DLIST_ITERATE_FROM_NODE(l, n) {
  77:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *         <user code>
  78:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     }
  79:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  80:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Like SYS_DLIST_FOR_EACH_NODE(), but __dn already contains a node in the list
  81:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * where to start searching for the next entry from. If NULL, it starts from
  82:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * the head.
  83:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  84:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dl A pointer on a sys_dlist_t to iterate on
  85:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dn A sys_dnode_t pointer to peek each node of the list;
  86:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *             it contains the starting node, or NULL to start from the head
  87:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
  88:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_ITERATE_FROM_NODE(__dl, __dn) \
  89:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	for (__dn = __dn ? sys_dlist_peek_next_no_check(__dl, __dn) \
  90:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 			 : sys_dlist_peek_head(__dl); \
  91:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	     __dn; \
  92:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	     __dn = sys_dlist_peek_next(__dl, __dn))
  93:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
  94:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
  95:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Provide the primitive to safely iterate on a list
  96:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Note: __dn can be removed, it will not break the loop.
  97:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
  98:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * User _MUST_ add the loop statement curly braces enclosing its own code:
  99:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 100:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     SYS_DLIST_FOR_EACH_NODE_SAFE(l, n, s) {
 101:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *         <user code>
 102:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     }
 103:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 104:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dl A pointer on a sys_dlist_t to iterate on
 105:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dn A sys_dnode_t pointer to peek each node of the list
 106:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dns A sys_dnode_t pointer for the loop to run safely
 107:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 108:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_FOR_EACH_NODE_SAFE(__dl, __dn, __dns)			\
 109:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	for (__dn = sys_dlist_peek_head(__dl),				\
 110:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		     __dns = sys_dlist_peek_next(__dl, __dn);  		\
 111:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	     __dn; __dn = __dns,					\
 112:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		     __dns = sys_dlist_peek_next(__dl, __dn))
 113:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 114:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /*
 115:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Provide the primitive to resolve the container of a list node
 116:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Note: it is safe to use with NULL pointer nodes
 117:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 118:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dn A pointer on a sys_dnode_t to get its container
ARM GAS  /tmp/cc4fe6my.s 			page 10


 119:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __cn Container struct type pointer
 120:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __n The field name of sys_dnode_t within the container struct
 121:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 122:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_CONTAINER(__dn, __cn, __n) \
 123:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	(__dn ? CONTAINER_OF(__dn, __typeof__(*__cn), __n) : NULL)
 124:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /*
 125:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Provide the primitive to peek container of the list head
 126:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 127:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dl A pointer on a sys_dlist_t to peek
 128:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __cn Container struct type pointer
 129:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __n The field name of sys_dnode_t within the container struct
 130:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 131:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_PEEK_HEAD_CONTAINER(__dl, __cn, __n) \
 132:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	SYS_DLIST_CONTAINER(sys_dlist_peek_head(__dl), __cn, __n)
 133:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 134:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /*
 135:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Provide the primitive to peek the next container
 136:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 137:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dl A pointer on a sys_dlist_t to peek
 138:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __cn Container struct type pointer
 139:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __n The field name of sys_dnode_t within the container struct
 140:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 141:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_PEEK_NEXT_CONTAINER(__dl, __cn, __n) \
 142:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	((__cn) ? SYS_DLIST_CONTAINER(sys_dlist_peek_next(__dl, &(__cn->__n)), \
 143:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 				      __cn, __n) : NULL)
 144:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 145:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 146:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Provide the primitive to iterate on a list under a container
 147:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Note: the loop is unsafe and thus __cn should not be detached
 148:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 149:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * User _MUST_ add the loop statement curly braces enclosing its own code:
 150:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 151:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     SYS_DLIST_FOR_EACH_CONTAINER(l, c, n) {
 152:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *         <user code>
 153:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     }
 154:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 155:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dl A pointer on a sys_dlist_t to iterate on
 156:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __cn A pointer to peek each entry of the list
 157:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __n The field name of sys_dnode_t within the container struct
 158:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 159:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_FOR_EACH_CONTAINER(__dl, __cn, __n)			\
 160:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	for (__cn = SYS_DLIST_PEEK_HEAD_CONTAINER(__dl, __cn, __n); __cn; \
 161:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	     __cn = SYS_DLIST_PEEK_NEXT_CONTAINER(__dl, __cn, __n))
 162:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 163:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 164:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief Provide the primitive to safely iterate on a list under a container
 165:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Note: __cn can be detached, it will not break the loop.
 166:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 167:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * User _MUST_ add the loop statement curly braces enclosing its own code:
 168:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 169:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     SYS_DLIST_FOR_EACH_CONTAINER_SAFE(l, c, cn, n) {
 170:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *         <user code>
 171:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *     }
 172:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 173:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __dl A pointer on a sys_dlist_t to iterate on
 174:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __cn A pointer to peek each entry of the list
 175:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __cns A pointer for the loop to run safely
ARM GAS  /tmp/cc4fe6my.s 			page 11


 176:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param __n The field name of sys_dnode_t within the container struct
 177:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 178:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_FOR_EACH_CONTAINER_SAFE(__dl, __cn, __cns, __n)	\
 179:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	for (__cn = SYS_DLIST_PEEK_HEAD_CONTAINER(__dl, __cn, __n),	\
 180:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	     __cns = SYS_DLIST_PEEK_NEXT_CONTAINER(__dl, __cn, __n); __cn; \
 181:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	     __cn = __cns,						\
 182:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	     __cns = SYS_DLIST_PEEK_NEXT_CONTAINER(__dl, __cn, __n))
 183:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 184:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 185:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief initialize list
 186:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 187:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list
 188:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 189:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return N/A
 190:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 191:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 192:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline void sys_dlist_init(sys_dlist_t *list)
 193:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 194:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->head = (sys_dnode_t *)list;
 195:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->tail = (sys_dnode_t *)list;
 196:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 197:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 198:../../../uLipeRtosPico/picokernel/inc/k_list.h **** #define SYS_DLIST_STATIC_INIT(ptr_to_list) {{(ptr_to_list)}, {(ptr_to_list)}}
 199:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 200:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 201:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief check if a node is the list's head
 202:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 203:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 204:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the node to check
 205:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 206:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return 1 if node is the head, 0 otherwise
 207:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 208:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 209:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline int sys_dlist_is_head(sys_dlist_t *list, sys_dnode_t *node)
 210:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 211:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return list->head == node;
 212:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 213:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 214:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 215:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief check if a node is the list's tail
 216:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 217:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 218:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the node to check
 219:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 220:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return 1 if node is the tail, 0 otherwise
 221:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 222:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 223:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline int sys_dlist_is_tail(sys_dlist_t *list, sys_dnode_t *node)
 224:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 225:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return list->tail == node;
 226:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 227:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 228:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 229:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief check if the list is empty
 230:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 231:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 232:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
ARM GAS  /tmp/cc4fe6my.s 			page 12


 233:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return 1 if empty, 0 otherwise
 234:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 235:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 236:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline int sys_dlist_is_empty(sys_dlist_t *list)
 237:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 238:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return list->head == list;
 158              		.loc 3 238 0
 159 0048 6068     		ldr	r0, [r4, #4]
 160              	.LVL17:
 161              	.LBE86:
 162              	.LBE85:
 239:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 240:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 241:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 242:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief check if more than one node present
 243:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 244:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 245:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 246:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return 1 if multiple nodes, 0 otherwise
 247:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 248:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 249:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline int sys_dlist_has_multiple_nodes(sys_dlist_t *list)
 250:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 251:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return list->head != list->tail;
 252:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 253:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 254:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 255:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief get a reference to the head item in the list
 256:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 257:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 258:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 259:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return a pointer to the head element, NULL if list is empty
 260:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 261:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 262:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline sys_dnode_t *sys_dlist_peek_head(sys_dlist_t *list)
 263:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 264:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return sys_dlist_is_empty(list) ? NULL : list->head;
 163              		.loc 3 264 0
 164 004a 8242     		cmp	r2, r0
 165 004c 02D0     		beq	.L21
 166              	.L14:
 167              	.LVL18:
 168              	.LBE84:
 169              	.LBE83:
 111:../../picokernel/k_kernel.c **** 	if(head != NULL)
 170              		.loc 1 111 0
 171 004e 18B1     		cbz	r0, .L16
 112:../../picokernel/k_kernel.c **** 		ret = CONTAINER_OF(head, tcb_t, thr_link);
 172              		.loc 1 112 0
 173 0050 2438     		subs	r0, r0, #36
 174              	.LVL19:
 175 0052 10BD     		pop	{r4, pc}
 176              	.LVL20:
 177              	.L21:
 178              	.LBB88:
 179              	.LBB87:
 180              		.loc 3 264 0
ARM GAS  /tmp/cc4fe6my.s 			page 13


 181 0054 0020     		movs	r0, #0
 182 0056 FAE7     		b	.L14
 183              	.LVL21:
 184              	.L16:
 185              	.LBE87:
 186              	.LBE88:
  80:../../picokernel/k_kernel.c **** 	k_list_t *head;
 187              		.loc 1 80 0
 188 0058 0248     		ldr	r0, .L22+8
 189              	.L13:
 190              	.LVL22:
 113:../../picokernel/k_kernel.c **** 
 114:../../picokernel/k_kernel.c **** cleanup:
 115:../../picokernel/k_kernel.c **** 	return(ret);
 116:../../picokernel/k_kernel.c **** }
 191              		.loc 1 116 0
 192 005a 10BD     		pop	{r4, pc}
 193              	.L23:
 194              		.align	2
 195              	.L22:
 196 005c 00000000 		.word	.LANCHOR1
 197 0060 00000000 		.word	k_current_task
 198 0064 00000000 		.word	.LANCHOR0
 199              		.cfi_endproc
 200              	.LFE21:
 202              		.section	.text.k_pend_obj,"ax",%progbits
 203              		.align	1
 204              		.global	k_pend_obj
 205              		.syntax unified
 206              		.thumb
 207              		.thumb_func
 208              		.fpu fpv4-sp-d16
 210              	k_pend_obj:
 211              	.LFB22:
 117:../../picokernel/k_kernel.c **** 
 118:../../picokernel/k_kernel.c **** 
 119:../../picokernel/k_kernel.c **** 
 120:../../picokernel/k_kernel.c **** /** public functions **/
 121:../../picokernel/k_kernel.c **** k_status_t k_pend_obj(tcb_t *thr, k_work_list_t *obj_list)
 122:../../picokernel/k_kernel.c **** {
 212              		.loc 1 122 0
 213              		.cfi_startproc
 214              		@ args = 0, pretend = 0, frame = 0
 215              		@ frame_needed = 0, uses_anonymous_args = 0
 216              	.LVL23:
 217 0000 10B5     		push	{r4, lr}
 218              	.LCFI2:
 219              		.cfi_def_cfa_offset 8
 220              		.cfi_offset 4, -8
 221              		.cfi_offset 14, -4
 222              	.LVL24:
 223              	.LBB89:
 224              	.LBB90:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 225              		.loc 2 128 0
 226 0002 28B3     		cbz	r0, .L32
 227 0004 0246     		mov	r2, r0
ARM GAS  /tmp/cc4fe6my.s 			page 14


 228              	.LVL25:
 229              	.LBE90:
 230              	.LBE89:
 231              	.LBB92:
 232              	.LBB93:
 233 0006 31B3     		cbz	r1, .L33
 234              	.LVL26:
 235              	.LBE93:
 236              	.LBE92:
 123:../../picokernel/k_kernel.c **** 	k_status_t err = k_status_ok;
 124:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(thr != NULL);
 125:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(obj_list != NULL);
 126:../../picokernel/k_kernel.c **** 
 127:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 128:../../picokernel/k_kernel.c **** 	if(k_running) {
 237              		.loc 1 128 0
 238 0008 164B     		ldr	r3, .L35
 239 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 240 000c 5BB1     		cbz	r3, .L29
 129:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 241              		.loc 1 129 0
 242 000e 164B     		ldr	r3, .L35+4
 243 0010 1868     		ldr	r0, [r3]
 244              	.LVL27:
 245 0012 0368     		ldr	r3, [r0]
 246 0014 4468     		ldr	r4, [r0, #4]
 247 0016 1B1B     		subs	r3, r3, r4
 248 0018 9B10     		asrs	r3, r3, #2
 249 001a 8360     		str	r3, [r0, #8]
 130:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 131:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 250              		.loc 1 131 0
 251 001c 0069     		ldr	r0, [r0, #16]
 252 001e 8000     		lsls	r0, r0, #2
 253              	.LVL28:
 254              	.LBB95:
 255              	.LBB96:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 256              		.loc 2 128 0
 257 0020 B0EB830F 		cmp	r0, r3, lsl #2
 258 0024 1AD3     		bcc	.L34
 259              	.LVL29:
 260              	.L29:
 261              	.LBE96:
 262              	.LBE95:
 132:../../picokernel/k_kernel.c **** 	}
 133:../../picokernel/k_kernel.c **** #endif
 134:../../picokernel/k_kernel.c **** 
 135:../../picokernel/k_kernel.c **** 
 136:../../picokernel/k_kernel.c **** 
 137:../../picokernel/k_kernel.c **** 	/*
 138:../../picokernel/k_kernel.c **** 	 * The insertion on obj_list consider that tasks are using priority ceilling
 139:../../picokernel/k_kernel.c **** 	 * or system threads, which priorities are < 0 , so we need to handle
 140:../../picokernel/k_kernel.c **** 	 * both cases, for negative priority we remove the signal and use its upper
 141:../../picokernel/k_kernel.c **** 	 * 3 bits to insert in system level priorities list
 142:../../picokernel/k_kernel.c **** 	 */
 143:../../picokernel/k_kernel.c **** 
ARM GAS  /tmp/cc4fe6my.s 			page 15


 144:../../picokernel/k_kernel.c **** 	obj_list->bitmap |= (1 << thr->thread_prio);
 263              		.loc 1 144 0
 264 0026 907B     		ldrb	r0, [r2, #14]	@ zero_extendqisi2
 265 0028 0123     		movs	r3, #1
 266 002a 03FA00F0 		lsl	r0, r3, r0
 267 002e 0B68     		ldr	r3, [r1]
 268 0030 0343     		orrs	r3, r3, r0
 269 0032 0B60     		str	r3, [r1]
 145:../../picokernel/k_kernel.c **** 	sys_dlist_append(&obj_list->list_head[thr->thread_prio], &thr->thr_link);
 270              		.loc 1 145 0
 271 0034 937B     		ldrb	r3, [r2, #14]	@ zero_extendqisi2
 272 0036 01EBC301 		add	r1, r1, r3, lsl #3
 273              	.LVL30:
 274 003a 081D     		adds	r0, r1, #4
 275 003c 02F12403 		add	r3, r2, #36
 276              	.LVL31:
 277              	.LBB98:
 278              	.LBB99:
 265:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 266:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 267:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 268:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief get a reference to the head item in the list
 269:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 270:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * The list must be known to be non-empty.
 271:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 272:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 273:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 274:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return a pointer to the head element
 275:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 276:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 277:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline sys_dnode_t *sys_dlist_peek_head_not_empty(sys_dlist_t *list)
 278:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 279:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return list->head;
 280:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 281:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 282:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 283:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief get a reference to the next item in the list, node is not NULL
 284:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 285:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Faster than sys_dlist_peek_next() if node is known not to be NULL.
 286:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 287:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 288:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the node from which to get the next element in the list
 289:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 290:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return a pointer to the next element from a node, NULL if node is the tail
 291:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 292:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 293:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline sys_dnode_t *sys_dlist_peek_next_no_check(sys_dlist_t *list,
 294:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 							sys_dnode_t *node)
 295:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 296:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return (node == list->tail) ? NULL : node->next;
 297:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 298:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 299:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 300:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief get a reference to the next item in the list
 301:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 302:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 303:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the node from which to get the next element in the list
ARM GAS  /tmp/cc4fe6my.s 			page 16


 304:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 305:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return a pointer to the next element from a node, NULL if node is the tail
 306:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * or NULL (when node comes from reading the head of an empty list).
 307:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 308:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 309:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline sys_dnode_t *sys_dlist_peek_next(sys_dlist_t *list,
 310:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 					       sys_dnode_t *node)
 311:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 312:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return node ? sys_dlist_peek_next_no_check(list, node) : NULL;
 313:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 314:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 315:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 316:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief get a reference to the tail item in the list
 317:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 318:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 319:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 320:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return a pointer to the tail element, NULL if list is empty
 321:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 322:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 323:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline sys_dnode_t *sys_dlist_peek_tail(sys_dlist_t *list)
 324:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 325:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	return sys_dlist_is_empty(list) ? NULL : list->tail;
 326:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 327:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 328:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 329:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief add node to tail of list
 330:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 331:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 332:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the element to append
 333:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 334:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return N/A
 335:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 336:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 337:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline void sys_dlist_append(sys_dlist_t *list, sys_dnode_t *node)
 338:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 339:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	node->next = list;
 279              		.loc 3 339 0
 280 0040 5062     		str	r0, [r2, #36]
 340:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	node->prev = list->tail;
 281              		.loc 3 340 0
 282 0042 8868     		ldr	r0, [r1, #8]
 283              	.LVL32:
 284 0044 9062     		str	r0, [r2, #40]
 341:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 342:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->tail->next = node;
 285              		.loc 3 342 0
 286 0046 8A68     		ldr	r2, [r1, #8]
 287              	.LVL33:
 288 0048 1360     		str	r3, [r2]
 289              	.LVL34:
 343:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->tail = node;
 290              		.loc 3 343 0
 291 004a 8B60     		str	r3, [r1, #8]
 292              	.LVL35:
 293              	.LBE99:
 294              	.LBE98:
 146:../../picokernel/k_kernel.c **** 
ARM GAS  /tmp/cc4fe6my.s 			page 17


 147:../../picokernel/k_kernel.c **** 
 148:../../picokernel/k_kernel.c **** 	return(err);
 149:../../picokernel/k_kernel.c **** 
 150:../../picokernel/k_kernel.c **** }
 295              		.loc 1 150 0
 296 004c 0020     		movs	r0, #0
 297 004e 10BD     		pop	{r4, pc}
 298              	.LVL36:
 299              	.L32:
 300              	.LBB100:
 301              	.LBB91:
 302              		.loc 2 129 0
 303 0050 FFF7FEFF 		bl	port_set_break
 304              	.LVL37:
 305              	.L26:
 306 0054 FEE7     		b	.L26
 307              	.LVL38:
 308              	.L33:
 309              	.LBE91:
 310              	.LBE100:
 311              	.LBB101:
 312              	.LBB94:
 313 0056 FFF7FEFF 		bl	port_set_break
 314              	.LVL39:
 315              	.L28:
 316 005a FEE7     		b	.L28
 317              	.LVL40:
 318              	.L34:
 319              	.LBE94:
 320              	.LBE101:
 321              	.LBB102:
 322              	.LBB97:
 323 005c FFF7FEFF 		bl	port_set_break
 324              	.LVL41:
 325              	.L30:
 326 0060 FEE7     		b	.L30
 327              	.L36:
 328 0062 00BF     		.align	2
 329              	.L35:
 330 0064 00000000 		.word	.LANCHOR1
 331 0068 00000000 		.word	k_current_task
 332              	.LBE97:
 333              	.LBE102:
 334              		.cfi_endproc
 335              	.LFE22:
 337              		.section	.text.k_unpend_obj,"ax",%progbits
 338              		.align	1
 339              		.global	k_unpend_obj
 340              		.syntax unified
 341              		.thumb
 342              		.thumb_func
 343              		.fpu fpv4-sp-d16
 345              	k_unpend_obj:
 346              	.LFB23:
 151:../../picokernel/k_kernel.c **** 
 152:../../picokernel/k_kernel.c **** tcb_t * k_unpend_obj(k_work_list_t *obj_list)
 153:../../picokernel/k_kernel.c **** {
ARM GAS  /tmp/cc4fe6my.s 			page 18


 347              		.loc 1 153 0
 348              		.cfi_startproc
 349              		@ args = 0, pretend = 0, frame = 0
 350              		@ frame_needed = 0, uses_anonymous_args = 0
 351              	.LVL42:
 352 0000 10B5     		push	{r4, lr}
 353              	.LCFI3:
 354              		.cfi_def_cfa_offset 8
 355              		.cfi_offset 4, -8
 356              		.cfi_offset 14, -4
 357              	.LVL43:
 358              	.LBB103:
 359              	.LBB104:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 360              		.loc 2 128 0
 361 0002 18B3     		cbz	r0, .L45
 362 0004 0446     		mov	r4, r0
 363              	.LVL44:
 364              	.LBE104:
 365              	.LBE103:
 154:../../picokernel/k_kernel.c **** 	tcb_t *thr = k_status_ok;
 155:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(obj_list != NULL);
 156:../../picokernel/k_kernel.c **** 
 157:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 158:../../picokernel/k_kernel.c **** 	if(k_running) {
 366              		.loc 1 158 0
 367 0006 194B     		ldr	r3, .L48
 368 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 369 000a 5BB1     		cbz	r3, .L40
 159:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 370              		.loc 1 159 0
 371 000c 184B     		ldr	r3, .L48+4
 372 000e 1A68     		ldr	r2, [r3]
 373 0010 1368     		ldr	r3, [r2]
 374 0012 5168     		ldr	r1, [r2, #4]
 375 0014 5B1A     		subs	r3, r3, r1
 376 0016 9B10     		asrs	r3, r3, #2
 377 0018 9360     		str	r3, [r2, #8]
 160:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 161:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 378              		.loc 1 161 0
 379 001a 1269     		ldr	r2, [r2, #16]
 380 001c 9200     		lsls	r2, r2, #2
 381              	.LVL45:
 382              	.LBB106:
 383              	.LBB107:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 384              		.loc 2 128 0
 385 001e B2EB830F 		cmp	r2, r3, lsl #2
 386 0022 16D3     		bcc	.L46
 387              	.LVL46:
 388              	.L40:
 389              	.LBE107:
 390              	.LBE106:
 162:../../picokernel/k_kernel.c **** 	}
 163:../../picokernel/k_kernel.c **** #endif
 164:../../picokernel/k_kernel.c **** 
ARM GAS  /tmp/cc4fe6my.s 			page 19


 165:../../picokernel/k_kernel.c **** 
 166:../../picokernel/k_kernel.c **** 	/*
 167:../../picokernel/k_kernel.c **** 	 * unpend a obj is a little bit complex relative to a
 168:../../picokernel/k_kernel.c **** 	 * make not ready, before to remove a item from a work list
 169:../../picokernel/k_kernel.c **** 	 * we need to know which object is the desired, to keep the
 170:../../picokernel/k_kernel.c **** 	 * kernel execution policy, we execute the fifo-sched on
 171:../../picokernel/k_kernel.c **** 	 * work list to obtain which is the highest priority task
 172:../../picokernel/k_kernel.c **** 	 * waiting for a kernel object and remove it from list
 173:../../picokernel/k_kernel.c **** 	 */
 174:../../picokernel/k_kernel.c **** 	thr = k_sched(obj_list);
 391              		.loc 1 174 0
 392 0024 2046     		mov	r0, r4
 393              	.LVL47:
 394 0026 FFF7FEFF 		bl	k_sched
 395              	.LVL48:
 175:../../picokernel/k_kernel.c **** 	if(thr == &idle_thread) {
 396              		.loc 1 175 0
 397 002a 124B     		ldr	r3, .L48+8
 398 002c 9842     		cmp	r0, r3
 399 002e 1BD0     		beq	.L43
 400              	.LVL49:
 401              	.LBB109:
 402              	.LBB110:
 344:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 345:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 346:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 347:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief add node to head of list
 348:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 349:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 350:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the element to append
 351:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 352:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return N/A
 353:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 354:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 355:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline void sys_dlist_prepend(sys_dlist_t *list, sys_dnode_t *node)
 356:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 357:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	node->next = list->head;
 358:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	node->prev = list;
 359:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 360:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->head->prev = node;
 361:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->head = node;
 362:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 363:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 364:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 365:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief insert node after a node
 366:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 367:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Insert a node after a specified node in a list.
 368:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 369:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 370:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param insert_point the insert point in the list: if NULL, insert at head
 371:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the element to append
 372:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 373:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return N/A
 374:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 375:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 376:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline void sys_dlist_insert_after(sys_dlist_t *list,
 377:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	sys_dnode_t *insert_point, sys_dnode_t *node)
ARM GAS  /tmp/cc4fe6my.s 			page 20


 378:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 379:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	if (!insert_point) {
 380:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		sys_dlist_prepend(list, node);
 381:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	} else {
 382:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		node->next = insert_point->next;
 383:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		node->prev = insert_point;
 384:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		insert_point->next->prev = node;
 385:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		insert_point->next = node;
 386:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	}
 387:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 388:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 389:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 390:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief insert node before a node
 391:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 392:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Insert a node before a specified node in a list.
 393:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 394:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 395:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param insert_point the insert point in the list: if NULL, insert at tail
 396:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the element to insert
 397:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 398:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return N/A
 399:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 400:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 401:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline void sys_dlist_insert_before(sys_dlist_t *list,
 402:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	sys_dnode_t *insert_point, sys_dnode_t *node)
 403:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 404:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	if (!insert_point) {
 405:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		sys_dlist_append(list, node);
 406:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	} else {
 407:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		node->prev = insert_point->prev;
 408:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		node->next = insert_point;
 409:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		insert_point->prev->next = node;
 410:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		insert_point->prev = node;
 411:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	}
 412:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 413:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 414:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 415:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief insert node at position
 416:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 417:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * Insert a node in a location depending on a external condition. The cond()
 418:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * function checks if the node is to be inserted _before_ the current node
 419:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * against which it is checked.
 420:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 421:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param list the doubly-linked list to operate on
 422:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the element to insert
 423:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param cond a function that determines if the current node is the correct
 424:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *             insert point
 425:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param data parameter to cond()
 426:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 427:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return N/A
 428:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 429:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 430:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline void sys_dlist_insert_at(sys_dlist_t *list, sys_dnode_t *node,
 431:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	int (*cond)(sys_dnode_t *, void *), void *data)
 432:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 433:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	if (sys_dlist_is_empty(list)) {
 434:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		sys_dlist_append(list, node);
ARM GAS  /tmp/cc4fe6my.s 			page 21


 435:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	} else {
 436:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		sys_dnode_t *pos = sys_dlist_peek_head(list);
 437:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 438:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		while (pos && !cond(pos, data)) {
 439:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 			pos = sys_dlist_peek_next(list, pos);
 440:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		}
 441:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 		sys_dlist_insert_before(list, pos, node);
 442:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	}
 443:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 444:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 445:../../../uLipeRtosPico/picokernel/inc/k_list.h **** /**
 446:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @brief remove a specific node from a list
 447:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 448:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * The list is implicit from the node. The node must be part of a list.
 449:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 450:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @param node the node to remove
 451:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  *
 452:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  * @return N/A
 453:../../../uLipeRtosPico/picokernel/inc/k_list.h ****  */
 454:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 455:../../../uLipeRtosPico/picokernel/inc/k_list.h **** static inline void sys_dlist_remove(sys_dnode_t *node)
 456:../../../uLipeRtosPico/picokernel/inc/k_list.h **** {
 457:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	node->prev->next = node->next;
 403              		.loc 3 457 0
 404 0030 836A     		ldr	r3, [r0, #40]
 405 0032 426A     		ldr	r2, [r0, #36]
 406 0034 1A60     		str	r2, [r3]
 458:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	node->next->prev = node->prev;
 407              		.loc 3 458 0
 408 0036 436A     		ldr	r3, [r0, #36]
 409 0038 826A     		ldr	r2, [r0, #40]
 410 003a 5A60     		str	r2, [r3, #4]
 411              	.LVL50:
 412              	.LBE110:
 413              	.LBE109:
 176:../../picokernel/k_kernel.c **** 		thr = NULL;
 177:../../picokernel/k_kernel.c **** 		goto cleanup;
 178:../../picokernel/k_kernel.c **** 	}
 179:../../picokernel/k_kernel.c **** 
 180:../../picokernel/k_kernel.c **** 	sys_dlist_remove(&thr->thr_link);
 181:../../picokernel/k_kernel.c **** 	if(sys_dlist_is_empty(&obj_list->list_head[thr->thread_prio])){
 414              		.loc 1 181 0
 415 003c 827B     		ldrb	r2, [r0, #14]	@ zero_extendqisi2
 416 003e 04EBC203 		add	r3, r4, r2, lsl #3
 417 0042 191D     		adds	r1, r3, #4
 418              	.LVL51:
 419              	.LBB111:
 420              	.LBB112:
 238:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 421              		.loc 3 238 0
 422 0044 5B68     		ldr	r3, [r3, #4]
 423              	.LVL52:
 424              	.LBE112:
 425              	.LBE111:
 426              		.loc 1 181 0
 427 0046 9942     		cmp	r1, r3
 428 0048 06D0     		beq	.L47
ARM GAS  /tmp/cc4fe6my.s 			page 22


 429              	.LVL53:
 430              	.L37:
 182:../../picokernel/k_kernel.c **** 		obj_list->bitmap &= ~(1 << thr->thread_prio);
 183:../../picokernel/k_kernel.c **** 	}
 184:../../picokernel/k_kernel.c **** 
 185:../../picokernel/k_kernel.c **** cleanup:
 186:../../picokernel/k_kernel.c **** 	return(thr);
 187:../../picokernel/k_kernel.c **** }
 431              		.loc 1 187 0
 432 004a 10BD     		pop	{r4, pc}
 433              	.LVL54:
 434              	.L45:
 435              	.LBB113:
 436              	.LBB105:
 437              		.loc 2 129 0
 438 004c FFF7FEFF 		bl	port_set_break
 439              	.LVL55:
 440              	.L39:
 441 0050 FEE7     		b	.L39
 442              	.LVL56:
 443              	.L46:
 444              	.LBE105:
 445              	.LBE113:
 446              	.LBB114:
 447              	.LBB108:
 448 0052 FFF7FEFF 		bl	port_set_break
 449              	.LVL57:
 450              	.L41:
 451 0056 FEE7     		b	.L41
 452              	.LVL58:
 453              	.L47:
 454              	.LBE108:
 455              	.LBE114:
 182:../../picokernel/k_kernel.c **** 		obj_list->bitmap &= ~(1 << thr->thread_prio);
 456              		.loc 1 182 0
 457 0058 0123     		movs	r3, #1
 458 005a 03FA02F2 		lsl	r2, r3, r2
 459 005e 2368     		ldr	r3, [r4]
 460 0060 23EA0203 		bic	r3, r3, r2
 461 0064 2360     		str	r3, [r4]
 462 0066 10BD     		pop	{r4, pc}
 463              	.LVL59:
 464              	.L43:
 176:../../picokernel/k_kernel.c **** 		goto cleanup;
 465              		.loc 1 176 0
 466 0068 0020     		movs	r0, #0
 467              	.LVL60:
 468              	.L42:
 186:../../picokernel/k_kernel.c **** }
 469              		.loc 1 186 0
 470 006a EEE7     		b	.L37
 471              	.L49:
 472              		.align	2
 473              	.L48:
 474 006c 00000000 		.word	.LANCHOR1
 475 0070 00000000 		.word	k_current_task
 476 0074 00000000 		.word	.LANCHOR0
ARM GAS  /tmp/cc4fe6my.s 			page 23


 477              		.cfi_endproc
 478              	.LFE23:
 480              		.section	.text.k_make_ready,"ax",%progbits
 481              		.align	1
 482              		.global	k_make_ready
 483              		.syntax unified
 484              		.thumb
 485              		.thumb_func
 486              		.fpu fpv4-sp-d16
 488              	k_make_ready:
 489              	.LFB24:
 188:../../picokernel/k_kernel.c **** 
 189:../../picokernel/k_kernel.c **** 
 190:../../picokernel/k_kernel.c **** k_status_t k_make_ready(tcb_t *thr)
 191:../../picokernel/k_kernel.c **** {
 490              		.loc 1 191 0
 491              		.cfi_startproc
 492              		@ args = 0, pretend = 0, frame = 0
 493              		@ frame_needed = 0, uses_anonymous_args = 0
 494              	.LVL61:
 495 0000 10B5     		push	{r4, lr}
 496              	.LCFI4:
 497              		.cfi_def_cfa_offset 8
 498              		.cfi_offset 4, -8
 499              		.cfi_offset 14, -4
 500              	.LVL62:
 501              	.LBB115:
 502              	.LBB116:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 503              		.loc 2 128 0
 504 0002 30B3     		cbz	r0, .L57
 505 0004 0246     		mov	r2, r0
 506              	.LVL63:
 507              	.LBE116:
 508              	.LBE115:
 192:../../picokernel/k_kernel.c **** 	k_status_t err = k_status_ok;
 193:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(thr != NULL);
 194:../../picokernel/k_kernel.c **** 
 195:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 196:../../picokernel/k_kernel.c **** 	if(k_running) {
 509              		.loc 1 196 0
 510 0006 164B     		ldr	r3, .L59
 511 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 512 000a 5BB1     		cbz	r3, .L53
 197:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 513              		.loc 1 197 0
 514 000c 154B     		ldr	r3, .L59+4
 515 000e 1968     		ldr	r1, [r3]
 516 0010 0B68     		ldr	r3, [r1]
 517 0012 4868     		ldr	r0, [r1, #4]
 518              	.LVL64:
 519 0014 1B1A     		subs	r3, r3, r0
 520 0016 9B10     		asrs	r3, r3, #2
 521 0018 8B60     		str	r3, [r1, #8]
 198:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 199:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 522              		.loc 1 199 0
ARM GAS  /tmp/cc4fe6my.s 			page 24


 523 001a 0969     		ldr	r1, [r1, #16]
 524 001c 8900     		lsls	r1, r1, #2
 525              	.LVL65:
 526              	.LBB118:
 527              	.LBB119:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 528              		.loc 2 128 0
 529 001e B1EB830F 		cmp	r1, r3, lsl #2
 530 0022 19D3     		bcc	.L58
 531              	.LVL66:
 532              	.L53:
 533              	.LBE119:
 534              	.LBE118:
 200:../../picokernel/k_kernel.c **** 	}
 201:../../picokernel/k_kernel.c **** #endif
 202:../../picokernel/k_kernel.c **** 
 203:../../picokernel/k_kernel.c **** 	/* to make ready evaluate if task does not waits for
 204:../../picokernel/k_kernel.c **** 	 * any more objects
 205:../../picokernel/k_kernel.c **** 	 */
 206:../../picokernel/k_kernel.c **** 	if((thr->thread_wait != 0))
 535              		.loc 1 206 0
 536 0024 9389     		ldrh	r3, [r2, #12]
 537 0026 93B9     		cbnz	r3, .L55
 207:../../picokernel/k_kernel.c **** 		goto cleanup;
 208:../../picokernel/k_kernel.c **** 
 209:../../picokernel/k_kernel.c **** 	/*
 210:../../picokernel/k_kernel.c **** 	 * The insertion on ready list consider that tasks are using priority ceilling
 211:../../picokernel/k_kernel.c **** 	 * or system threads, which priorities are < 0 , so we need to handle
 212:../../picokernel/k_kernel.c **** 	 * both cases, for negative priority we remove the signal and use its upper
 213:../../picokernel/k_kernel.c **** 	 * 3 bits to insert in system level priorities list
 214:../../picokernel/k_kernel.c **** 	 */
 215:../../picokernel/k_kernel.c **** 	k_rdy_list.bitmap |= (1 << thr->thread_prio);
 538              		.loc 1 215 0
 539 0028 947B     		ldrb	r4, [r2, #14]	@ zero_extendqisi2
 540 002a 0121     		movs	r1, #1
 541 002c 01FA04F0 		lsl	r0, r1, r4
 542 0030 0D4B     		ldr	r3, .L59+8
 543 0032 1968     		ldr	r1, [r3]
 544 0034 0143     		orrs	r1, r1, r0
 545 0036 1960     		str	r1, [r3]
 216:../../picokernel/k_kernel.c **** 	sys_dlist_append(&k_rdy_list.list_head[thr->thread_prio], &thr->thr_link);
 546              		.loc 1 216 0
 547 0038 03EBC403 		add	r3, r3, r4, lsl #3
 548 003c 181D     		adds	r0, r3, #4
 549 003e 02F12401 		add	r1, r2, #36
 550              	.LVL67:
 551              	.LBB121:
 552              	.LBB122:
 339:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	node->prev = list->tail;
 553              		.loc 3 339 0
 554 0042 5062     		str	r0, [r2, #36]
 340:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 
 555              		.loc 3 340 0
 556 0044 9868     		ldr	r0, [r3, #8]
 557              	.LVL68:
 558 0046 9062     		str	r0, [r2, #40]
 342:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->tail = node;
ARM GAS  /tmp/cc4fe6my.s 			page 25


 559              		.loc 3 342 0
 560 0048 9A68     		ldr	r2, [r3, #8]
 561              	.LVL69:
 562 004a 1160     		str	r1, [r2]
 563              	.LVL70:
 343:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 564              		.loc 3 343 0
 565 004c 9960     		str	r1, [r3, #8]
 566              	.LVL71:
 567              	.L55:
 568              	.LBE122:
 569              	.LBE121:
 217:../../picokernel/k_kernel.c **** 
 218:../../picokernel/k_kernel.c **** 
 219:../../picokernel/k_kernel.c **** cleanup:
 220:../../picokernel/k_kernel.c **** 	return(err);
 221:../../picokernel/k_kernel.c **** }
 570              		.loc 1 221 0
 571 004e 0020     		movs	r0, #0
 572 0050 10BD     		pop	{r4, pc}
 573              	.LVL72:
 574              	.L57:
 575              	.LBB123:
 576              	.LBB117:
 577              		.loc 2 129 0
 578 0052 FFF7FEFF 		bl	port_set_break
 579              	.LVL73:
 580              	.L52:
 581 0056 FEE7     		b	.L52
 582              	.LVL74:
 583              	.L58:
 584              	.LBE117:
 585              	.LBE123:
 586              	.LBB124:
 587              	.LBB120:
 588 0058 FFF7FEFF 		bl	port_set_break
 589              	.LVL75:
 590              	.L54:
 591 005c FEE7     		b	.L54
 592              	.L60:
 593 005e 00BF     		.align	2
 594              	.L59:
 595 0060 00000000 		.word	.LANCHOR1
 596 0064 00000000 		.word	k_current_task
 597 0068 00000000 		.word	.LANCHOR2
 598              	.LBE120:
 599              	.LBE124:
 600              		.cfi_endproc
 601              	.LFE24:
 603              		.section	.text.k_make_not_ready,"ax",%progbits
 604              		.align	1
 605              		.global	k_make_not_ready
 606              		.syntax unified
 607              		.thumb
 608              		.thumb_func
 609              		.fpu fpv4-sp-d16
 611              	k_make_not_ready:
ARM GAS  /tmp/cc4fe6my.s 			page 26


 612              	.LFB25:
 222:../../picokernel/k_kernel.c **** 
 223:../../picokernel/k_kernel.c **** k_status_t k_make_not_ready(tcb_t *thr)
 224:../../picokernel/k_kernel.c **** {
 613              		.loc 1 224 0
 614              		.cfi_startproc
 615              		@ args = 0, pretend = 0, frame = 0
 616              		@ frame_needed = 0, uses_anonymous_args = 0
 617              	.LVL76:
 618 0000 08B5     		push	{r3, lr}
 619              	.LCFI5:
 620              		.cfi_def_cfa_offset 8
 621              		.cfi_offset 3, -8
 622              		.cfi_offset 14, -4
 623              	.LVL77:
 624              	.LBB125:
 625              	.LBB126:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 626              		.loc 2 128 0
 627 0002 F8B1     		cbz	r0, .L68
 628 0004 0246     		mov	r2, r0
 629              	.LVL78:
 630              	.LBE126:
 631              	.LBE125:
 225:../../picokernel/k_kernel.c **** 	k_status_t err = k_status_ok;
 226:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(thr != NULL);
 227:../../picokernel/k_kernel.c **** 
 228:../../picokernel/k_kernel.c **** 	/*
 229:../../picokernel/k_kernel.c **** 	 * for remotion we need care both priority cases as well,
 230:../../picokernel/k_kernel.c **** 	 * and before clear a priorty level bitmap, we need to make sure
 231:../../picokernel/k_kernel.c **** 	 * there is no further tasks which share the priority of thr
 232:../../picokernel/k_kernel.c **** 	 *
 233:../../picokernel/k_kernel.c **** 	 */
 234:../../picokernel/k_kernel.c **** 
 235:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 236:../../picokernel/k_kernel.c **** 	if(k_running) {
 632              		.loc 1 236 0
 633 0006 174B     		ldr	r3, .L71
 634 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 635 000a 5BB1     		cbz	r3, .L64
 237:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 636              		.loc 1 237 0
 637 000c 164B     		ldr	r3, .L71+4
 638 000e 1968     		ldr	r1, [r3]
 639 0010 0B68     		ldr	r3, [r1]
 640 0012 4868     		ldr	r0, [r1, #4]
 641              	.LVL79:
 642 0014 1B1A     		subs	r3, r3, r0
 643 0016 9B10     		asrs	r3, r3, #2
 644 0018 8B60     		str	r3, [r1, #8]
 238:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 239:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 645              		.loc 1 239 0
 646 001a 0969     		ldr	r1, [r1, #16]
 647 001c 8900     		lsls	r1, r1, #2
 648              	.LVL80:
 649              	.LBB128:
ARM GAS  /tmp/cc4fe6my.s 			page 27


 650              	.LBB129:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 651              		.loc 2 128 0
 652 001e B1EB830F 		cmp	r1, r3, lsl #2
 653 0022 12D3     		bcc	.L69
 654              	.LVL81:
 655              	.L64:
 656              	.LBE129:
 657              	.LBE128:
 658              	.LBB131:
 659              	.LBB132:
 457:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	node->next->prev = node->prev;
 660              		.loc 3 457 0
 661 0024 936A     		ldr	r3, [r2, #40]
 662 0026 516A     		ldr	r1, [r2, #36]
 663 0028 1960     		str	r1, [r3]
 664              		.loc 3 458 0
 665 002a 536A     		ldr	r3, [r2, #36]
 666 002c 916A     		ldr	r1, [r2, #40]
 667 002e 5960     		str	r1, [r3, #4]
 668              	.LVL82:
 669              	.LBE132:
 670              	.LBE131:
 240:../../picokernel/k_kernel.c **** 	}
 241:../../picokernel/k_kernel.c **** #endif
 242:../../picokernel/k_kernel.c **** 
 243:../../picokernel/k_kernel.c **** 
 244:../../picokernel/k_kernel.c **** 
 245:../../picokernel/k_kernel.c **** 	sys_dlist_remove(&thr->thr_link);
 246:../../picokernel/k_kernel.c **** 	if(sys_dlist_is_empty(&k_rdy_list.list_head[thr->thread_prio])) {
 671              		.loc 1 246 0
 672 0030 927B     		ldrb	r2, [r2, #14]	@ zero_extendqisi2
 673              	.LVL83:
 674 0032 0E4B     		ldr	r3, .L71+8
 675 0034 03EBC203 		add	r3, r3, r2, lsl #3
 676 0038 191D     		adds	r1, r3, #4
 677              	.LVL84:
 678              	.LBB133:
 679              	.LBB134:
 238:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 680              		.loc 3 238 0
 681 003a 5B68     		ldr	r3, [r3, #4]
 682              	.LVL85:
 683              	.LBE134:
 684              	.LBE133:
 685              		.loc 1 246 0
 686 003c 9942     		cmp	r1, r3
 687 003e 07D0     		beq	.L70
 688              	.L66:
 247:../../picokernel/k_kernel.c **** 		k_rdy_list.bitmap &= ~(1 << thr->thread_prio);
 248:../../picokernel/k_kernel.c **** 	}
 249:../../picokernel/k_kernel.c **** 
 250:../../picokernel/k_kernel.c **** 
 251:../../picokernel/k_kernel.c **** 
 252:../../picokernel/k_kernel.c **** 	return(err);
 253:../../picokernel/k_kernel.c **** 
 254:../../picokernel/k_kernel.c **** }
ARM GAS  /tmp/cc4fe6my.s 			page 28


 689              		.loc 1 254 0
 690 0040 0020     		movs	r0, #0
 691 0042 08BD     		pop	{r3, pc}
 692              	.LVL86:
 693              	.L68:
 694              	.LBB135:
 695              	.LBB127:
 696              		.loc 2 129 0
 697 0044 FFF7FEFF 		bl	port_set_break
 698              	.LVL87:
 699              	.L63:
 700 0048 FEE7     		b	.L63
 701              	.LVL88:
 702              	.L69:
 703              	.LBE127:
 704              	.LBE135:
 705              	.LBB136:
 706              	.LBB130:
 707 004a FFF7FEFF 		bl	port_set_break
 708              	.LVL89:
 709              	.L65:
 710 004e FEE7     		b	.L65
 711              	.L70:
 712              	.LBE130:
 713              	.LBE136:
 247:../../picokernel/k_kernel.c **** 		k_rdy_list.bitmap &= ~(1 << thr->thread_prio);
 714              		.loc 1 247 0
 715 0050 0123     		movs	r3, #1
 716 0052 03FA02F2 		lsl	r2, r3, r2
 717 0056 0549     		ldr	r1, .L71+8
 718 0058 0B68     		ldr	r3, [r1]
 719 005a 23EA0203 		bic	r3, r3, r2
 720 005e 0B60     		str	r3, [r1]
 721 0060 EEE7     		b	.L66
 722              	.L72:
 723 0062 00BF     		.align	2
 724              	.L71:
 725 0064 00000000 		.word	.LANCHOR1
 726 0068 00000000 		.word	k_current_task
 727 006c 00000000 		.word	.LANCHOR2
 728              		.cfi_endproc
 729              	.LFE25:
 731              		.section	.text.k_yield,"ax",%progbits
 732              		.align	1
 733              		.global	k_yield
 734              		.syntax unified
 735              		.thumb
 736              		.thumb_func
 737              		.fpu fpv4-sp-d16
 739              	k_yield:
 740              	.LFB26:
 255:../../picokernel/k_kernel.c **** 
 256:../../picokernel/k_kernel.c **** bool k_yield(tcb_t *t)
 257:../../picokernel/k_kernel.c **** {
 741              		.loc 1 257 0
 742              		.cfi_startproc
 743              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/cc4fe6my.s 			page 29


 744              		@ frame_needed = 0, uses_anonymous_args = 0
 745              	.LVL90:
 746 0000 10B5     		push	{r4, lr}
 747              	.LCFI6:
 748              		.cfi_def_cfa_offset 8
 749              		.cfi_offset 4, -8
 750              		.cfi_offset 14, -4
 751              	.LVL91:
 752              	.LBB137:
 753              	.LBB138:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 754              		.loc 2 128 0
 755 0002 90B1     		cbz	r0, .L85
 756 0004 0446     		mov	r4, r0
 757              	.LVL92:
 758              	.LBE138:
 759              	.LBE137:
 258:../../picokernel/k_kernel.c **** 	k_status_t err = k_status_ok;
 259:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(t != NULL);
 260:../../picokernel/k_kernel.c **** 
 261:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 262:../../picokernel/k_kernel.c **** 	if(k_running) {
 760              		.loc 1 262 0
 761 0006 164B     		ldr	r3, .L86
 762 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 763 000a 8BB1     		cbz	r3, .L76
 263:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 764              		.loc 1 263 0
 765 000c 154B     		ldr	r3, .L86+4
 766 000e 1A68     		ldr	r2, [r3]
 767 0010 1368     		ldr	r3, [r2]
 768 0012 5168     		ldr	r1, [r2, #4]
 769 0014 5B1A     		subs	r3, r3, r1
 770 0016 9B10     		asrs	r3, r3, #2
 771 0018 9360     		str	r3, [r2, #8]
 264:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 265:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 772              		.loc 1 265 0
 773 001a 1269     		ldr	r2, [r2, #16]
 774 001c 9200     		lsls	r2, r2, #2
 775              	.LVL93:
 776              	.LBB140:
 777              	.LBB141:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 778              		.loc 2 128 0
 779 001e B2EB830F 		cmp	r2, r3, lsl #2
 780 0022 05D2     		bcs	.L76
 781              		.loc 2 129 0
 782 0024 FFF7FEFF 		bl	port_set_break
 783              	.LVL94:
 784              	.L77:
 785 0028 FEE7     		b	.L77
 786              	.LVL95:
 787              	.L85:
 788              	.LBE141:
 789              	.LBE140:
 790              	.LBB142:
ARM GAS  /tmp/cc4fe6my.s 			page 30


 791              	.LBB139:
 792 002a FFF7FEFF 		bl	port_set_break
 793              	.LVL96:
 794              	.L75:
 795 002e FEE7     		b	.L75
 796              	.LVL97:
 797              	.L76:
 798              	.LBE139:
 799              	.LBE142:
 266:../../picokernel/k_kernel.c **** 	}
 267:../../picokernel/k_kernel.c **** #endif
 268:../../picokernel/k_kernel.c **** 
 269:../../picokernel/k_kernel.c **** 
 270:../../picokernel/k_kernel.c **** 
 271:../../picokernel/k_kernel.c **** 	bool resched = false;
 272:../../picokernel/k_kernel.c **** 
 273:../../picokernel/k_kernel.c **** 
 274:../../picokernel/k_kernel.c **** 	err = k_make_not_ready(t);
 800              		.loc 1 274 0
 801 0030 2046     		mov	r0, r4
 802              	.LVL98:
 803 0032 FFF7FEFF 		bl	k_make_not_ready
 804              	.LVL99:
 805              	.LBB143:
 806              	.LBB144:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 807              		.loc 2 128 0
 808 0036 10B1     		cbz	r0, .L78
 809              		.loc 2 129 0
 810 0038 FFF7FEFF 		bl	port_set_break
 811              	.LVL100:
 812              	.L79:
 813 003c FEE7     		b	.L79
 814              	.LVL101:
 815              	.L78:
 816              	.LBE144:
 817              	.LBE143:
 275:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(err == k_status_ok);
 276:../../picokernel/k_kernel.c **** 
 277:../../picokernel/k_kernel.c **** 
 278:../../picokernel/k_kernel.c **** 	err = k_make_ready(t);
 818              		.loc 1 278 0
 819 003e 2046     		mov	r0, r4
 820              	.LVL102:
 821 0040 FFF7FEFF 		bl	k_make_ready
 822              	.LVL103:
 823              	.LBB145:
 824              	.LBB146:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 825              		.loc 2 128 0
 826 0044 10B1     		cbz	r0, .L80
 827              		.loc 2 129 0
 828 0046 FFF7FEFF 		bl	port_set_break
 829              	.LVL104:
 830              	.L81:
 831 004a FEE7     		b	.L81
 832              	.LVL105:
ARM GAS  /tmp/cc4fe6my.s 			page 31


 833              	.L80:
 834              	.LBE146:
 835              	.LBE145:
 279:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(err == k_status_ok);
 280:../../picokernel/k_kernel.c **** 
 281:../../picokernel/k_kernel.c **** 	/* check if anything changed durring send to back
 282:../../picokernel/k_kernel.c **** 	 * operation
 283:../../picokernel/k_kernel.c **** 	 */
 284:../../picokernel/k_kernel.c **** 	if(k_sched(&k_rdy_list) != t) {
 836              		.loc 1 284 0
 837 004c 0648     		ldr	r0, .L86+8
 838              	.LVL106:
 839 004e FFF7FEFF 		bl	k_sched
 840              	.LVL107:
 841 0052 8442     		cmp	r4, r0
 842 0054 01D1     		bne	.L83
 271:../../picokernel/k_kernel.c **** 
 843              		.loc 1 271 0
 844 0056 0020     		movs	r0, #0
 845 0058 10BD     		pop	{r4, pc}
 846              	.LVL108:
 847              	.L83:
 285:../../picokernel/k_kernel.c **** 		resched = true;
 848              		.loc 1 285 0
 849 005a 0120     		movs	r0, #1
 850              	.LVL109:
 286:../../picokernel/k_kernel.c **** 	}
 287:../../picokernel/k_kernel.c **** 
 288:../../picokernel/k_kernel.c **** 	return(resched);
 289:../../picokernel/k_kernel.c **** }
 851              		.loc 1 289 0
 852 005c 10BD     		pop	{r4, pc}
 853              	.LVL110:
 854              	.L87:
 855 005e 00BF     		.align	2
 856              	.L86:
 857 0060 00000000 		.word	.LANCHOR1
 858 0064 00000000 		.word	k_current_task
 859 0068 00000000 		.word	.LANCHOR2
 860              		.cfi_endproc
 861              	.LFE26:
 863              		.section	.text.k_sched_and_swap,"ax",%progbits
 864              		.align	1
 865              		.global	k_sched_and_swap
 866              		.syntax unified
 867              		.thumb
 868              		.thumb_func
 869              		.fpu fpv4-sp-d16
 871              	k_sched_and_swap:
 872              	.LFB27:
 290:../../picokernel/k_kernel.c **** 
 291:../../picokernel/k_kernel.c **** k_status_t k_sched_and_swap(void)
 292:../../picokernel/k_kernel.c **** {
 873              		.loc 1 292 0
 874              		.cfi_startproc
 875              		@ args = 0, pretend = 0, frame = 0
 876              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/cc4fe6my.s 			page 32


 877 0000 08B5     		push	{r3, lr}
 878              	.LCFI7:
 879              		.cfi_def_cfa_offset 8
 880              		.cfi_offset 3, -8
 881              		.cfi_offset 14, -4
 882              	.LVL111:
 293:../../picokernel/k_kernel.c **** 	k_status_t ret = k_status_ok;
 294:../../picokernel/k_kernel.c **** 
 295:../../picokernel/k_kernel.c **** 	if(!k_running){
 883              		.loc 1 295 0
 884 0002 184B     		ldr	r3, .L100
 885 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 886 0006 4BB3     		cbz	r3, .L93
 296:../../picokernel/k_kernel.c **** 		ret = k_status_error;
 297:../../picokernel/k_kernel.c **** 		goto cleanup;
 298:../../picokernel/k_kernel.c **** 	}
 299:../../picokernel/k_kernel.c **** 
 300:../../picokernel/k_kernel.c **** 	/*
 301:../../picokernel/k_kernel.c **** 	 * the sched and swap has the possibility to perform a
 302:../../picokernel/k_kernel.c **** 	 * context switch, so we need ensure the if in a ISR
 303:../../picokernel/k_kernel.c **** 	 * that all ISRs was processed and scheduling is the
 304:../../picokernel/k_kernel.c **** 	 * last ISR to process
 305:../../picokernel/k_kernel.c **** 	 */
 306:../../picokernel/k_kernel.c **** 	if(irq_counter > 0){
 887              		.loc 1 306 0
 888 0008 174B     		ldr	r3, .L100+4
 889 000a 1B68     		ldr	r3, [r3]
 890 000c 0BB1     		cbz	r3, .L97
 307:../../picokernel/k_kernel.c **** 		ret = k_status_sched_locked;
 891              		.loc 1 307 0
 892 000e 0320     		movs	r0, #3
 893 0010 08BD     		pop	{r3, pc}
 894              	.L97:
 308:../../picokernel/k_kernel.c **** 		goto cleanup;
 309:../../picokernel/k_kernel.c **** 	}
 310:../../picokernel/k_kernel.c **** 
 311:../../picokernel/k_kernel.c **** 
 312:../../picokernel/k_kernel.c **** 	k_high_prio_task = k_sched(&k_rdy_list);
 895              		.loc 1 312 0
 896 0012 1648     		ldr	r0, .L100+8
 897 0014 FFF7FEFF 		bl	k_sched
 898              	.LVL112:
 899 0018 154B     		ldr	r3, .L100+12
 900 001a 1860     		str	r0, [r3]
 313:../../picokernel/k_kernel.c **** 	if(k_high_prio_task == NULL) {
 901              		.loc 1 313 0
 902 001c C0B1     		cbz	r0, .L98
 903              	.L90:
 314:../../picokernel/k_kernel.c **** 		/* no other tasks ready to run, puts the idle thread */
 315:../../picokernel/k_kernel.c **** 		k_high_prio_task = &idle_thread;
 316:../../picokernel/k_kernel.c **** 	}
 317:../../picokernel/k_kernel.c **** 
 318:../../picokernel/k_kernel.c **** 
 319:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 320:../../picokernel/k_kernel.c **** 	if(k_running) {
 904              		.loc 1 320 0
 905 001e 114B     		ldr	r3, .L100
ARM GAS  /tmp/cc4fe6my.s 			page 33


 906 0020 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 907 0022 5BB1     		cbz	r3, .L91
 321:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 908              		.loc 1 321 0
 909 0024 134B     		ldr	r3, .L100+16
 910 0026 1A68     		ldr	r2, [r3]
 911 0028 1368     		ldr	r3, [r2]
 912 002a 5168     		ldr	r1, [r2, #4]
 913 002c 5B1A     		subs	r3, r3, r1
 914 002e 9B10     		asrs	r3, r3, #2
 915 0030 9360     		str	r3, [r2, #8]
 322:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 323:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 916              		.loc 1 323 0
 917 0032 1269     		ldr	r2, [r2, #16]
 918 0034 9200     		lsls	r2, r2, #2
 919              	.LVL113:
 920              	.LBB147:
 921              	.LBB148:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 922              		.loc 2 128 0
 923 0036 B2EB830F 		cmp	r2, r3, lsl #2
 924 003a 0CD3     		bcc	.L99
 925              	.LVL114:
 926              	.L91:
 927              	.LBE148:
 928              	.LBE147:
 324:../../picokernel/k_kernel.c **** 	}
 325:../../picokernel/k_kernel.c **** #endif
 326:../../picokernel/k_kernel.c **** 
 327:../../picokernel/k_kernel.c **** 
 328:../../picokernel/k_kernel.c **** 
 329:../../picokernel/k_kernel.c **** 	if(k_high_prio_task != k_current_task) {
 929              		.loc 1 329 0
 930 003c 0C4B     		ldr	r3, .L100+12
 931 003e 1A68     		ldr	r2, [r3]
 932 0040 0C4B     		ldr	r3, .L100+16
 933 0042 1B68     		ldr	r3, [r3]
 934 0044 9A42     		cmp	r2, r3
 935 0046 0BD0     		beq	.L95
 330:../../picokernel/k_kernel.c **** 		/* new high priority task, perform a swap request */
 331:../../picokernel/k_kernel.c **** 		port_swap_req();
 936              		.loc 1 331 0
 937 0048 FFF7FEFF 		bl	port_swap_req
 938              	.LVL115:
 293:../../picokernel/k_kernel.c **** 
 939              		.loc 1 293 0
 940 004c 0020     		movs	r0, #0
 941 004e 08BD     		pop	{r3, pc}
 942              	.L98:
 315:../../picokernel/k_kernel.c **** 	}
 943              		.loc 1 315 0
 944 0050 094A     		ldr	r2, .L100+20
 945 0052 1A60     		str	r2, [r3]
 946 0054 E3E7     		b	.L90
 947              	.LVL116:
 948              	.L99:
ARM GAS  /tmp/cc4fe6my.s 			page 34


 949              	.LBB150:
 950              	.LBB149:
 951              		.loc 2 129 0
 952 0056 FFF7FEFF 		bl	port_set_break
 953              	.LVL117:
 954              	.L92:
 955 005a FEE7     		b	.L92
 956              	.L93:
 957              	.LBE149:
 958              	.LBE150:
 296:../../picokernel/k_kernel.c **** 		goto cleanup;
 959              		.loc 1 296 0
 960 005c 0120     		movs	r0, #1
 961 005e 08BD     		pop	{r3, pc}
 962              	.L95:
 293:../../picokernel/k_kernel.c **** 
 963              		.loc 1 293 0
 964 0060 0020     		movs	r0, #0
 965              	.L89:
 966              	.LVL118:
 332:../../picokernel/k_kernel.c **** 	}
 333:../../picokernel/k_kernel.c **** 
 334:../../picokernel/k_kernel.c **** cleanup:
 335:../../picokernel/k_kernel.c **** 	return(ret);
 336:../../picokernel/k_kernel.c **** }
 967              		.loc 1 336 0
 968 0062 08BD     		pop	{r3, pc}
 969              	.L101:
 970              		.align	2
 971              	.L100:
 972 0064 00000000 		.word	.LANCHOR1
 973 0068 00000000 		.word	.LANCHOR3
 974 006c 00000000 		.word	.LANCHOR2
 975 0070 00000000 		.word	k_high_prio_task
 976 0074 00000000 		.word	k_current_task
 977 0078 00000000 		.word	.LANCHOR0
 978              		.cfi_endproc
 979              	.LFE27:
 981              		.section	.text.k_work_list_init,"ax",%progbits
 982              		.align	1
 983              		.global	k_work_list_init
 984              		.syntax unified
 985              		.thumb
 986              		.thumb_func
 987              		.fpu fpv4-sp-d16
 989              	k_work_list_init:
 990              	.LFB28:
 337:../../picokernel/k_kernel.c **** 
 338:../../picokernel/k_kernel.c **** 
 339:../../picokernel/k_kernel.c **** 
 340:../../picokernel/k_kernel.c **** void k_work_list_init(k_work_list_t *l)
 341:../../picokernel/k_kernel.c **** {
 991              		.loc 1 341 0
 992              		.cfi_startproc
 993              		@ args = 0, pretend = 0, frame = 0
 994              		@ frame_needed = 0, uses_anonymous_args = 0
 995              	.LVL119:
ARM GAS  /tmp/cc4fe6my.s 			page 35


 996 0000 08B5     		push	{r3, lr}
 997              	.LCFI8:
 998              		.cfi_def_cfa_offset 8
 999              		.cfi_offset 3, -8
 1000              		.cfi_offset 14, -4
 342:../../picokernel/k_kernel.c **** 
 343:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 344:../../picokernel/k_kernel.c **** 	if(k_running) {
 1001              		.loc 1 344 0
 1002 0002 0F4B     		ldr	r3, .L109
 1003 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1004 0006 5BB1     		cbz	r3, .L103
 345:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 1005              		.loc 1 345 0
 1006 0008 0E4B     		ldr	r3, .L109+4
 1007 000a 1A68     		ldr	r2, [r3]
 1008 000c 1368     		ldr	r3, [r2]
 1009 000e 5168     		ldr	r1, [r2, #4]
 1010 0010 5B1A     		subs	r3, r3, r1
 1011 0012 9B10     		asrs	r3, r3, #2
 1012 0014 9360     		str	r3, [r2, #8]
 346:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 347:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 1013              		.loc 1 347 0
 1014 0016 1269     		ldr	r2, [r2, #16]
 1015 0018 9200     		lsls	r2, r2, #2
 1016              	.LVL120:
 1017              	.LBB151:
 1018              	.LBB152:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 1019              		.loc 2 128 0
 1020 001a B2EB830F 		cmp	r2, r3, lsl #2
 1021 001e 02D3     		bcc	.L108
 1022              	.LVL121:
 1023              	.L103:
 1024              	.LBE152:
 1025              	.LBE151:
 348:../../picokernel/k_kernel.c **** 	}
 349:../../picokernel/k_kernel.c **** #endif
 350:../../picokernel/k_kernel.c **** 
 351:../../picokernel/k_kernel.c **** 
 352:../../picokernel/k_kernel.c **** 	l->bitmap = 0;
 1026              		.loc 1 352 0
 1027 0020 0023     		movs	r3, #0
 1028 0022 0360     		str	r3, [r0]
 1029              	.LVL122:
 1030              	.LBB154:
 353:../../picokernel/k_kernel.c **** 	for(uint8_t i=0; i < K_PRIORITY_LEVELS ; i++)
 1031              		.loc 1 353 0
 1032 0024 09E0     		b	.L105
 1033              	.LVL123:
 1034              	.L108:
 1035              	.LBE154:
 1036              	.LBB157:
 1037              	.LBB153:
 1038              		.loc 2 129 0
 1039 0026 FFF7FEFF 		bl	port_set_break
ARM GAS  /tmp/cc4fe6my.s 			page 36


 1040              	.LVL124:
 1041              	.L104:
 1042 002a FEE7     		b	.L104
 1043              	.LVL125:
 1044              	.L106:
 1045              	.LBE153:
 1046              	.LBE157:
 1047              	.LBB158:
 354:../../picokernel/k_kernel.c **** 		sys_dlist_init(&l->list_head[i]);
 1048              		.loc 1 354 0 discriminator 3
 1049 002c 00EBC302 		add	r2, r0, r3, lsl #3
 1050 0030 111D     		adds	r1, r2, #4
 1051              	.LVL126:
 1052              	.LBB155:
 1053              	.LBB156:
 194:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->tail = (sys_dnode_t *)list;
 1054              		.loc 3 194 0 discriminator 3
 1055 0032 5160     		str	r1, [r2, #4]
 195:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 1056              		.loc 3 195 0 discriminator 3
 1057 0034 9160     		str	r1, [r2, #8]
 1058              	.LVL127:
 1059              	.LBE156:
 1060              	.LBE155:
 353:../../picokernel/k_kernel.c **** 		sys_dlist_init(&l->list_head[i]);
 1061              		.loc 1 353 0 discriminator 3
 1062 0036 0133     		adds	r3, r3, #1
 1063              	.LVL128:
 1064 0038 DBB2     		uxtb	r3, r3
 1065              	.LVL129:
 1066              	.L105:
 353:../../picokernel/k_kernel.c **** 		sys_dlist_init(&l->list_head[i]);
 1067              		.loc 1 353 0 is_stmt 0 discriminator 1
 1068 003a 1F2B     		cmp	r3, #31
 1069 003c F6D9     		bls	.L106
 1070              	.LBE158:
 355:../../picokernel/k_kernel.c **** }
 1071              		.loc 1 355 0 is_stmt 1
 1072 003e 08BD     		pop	{r3, pc}
 1073              	.LVL130:
 1074              	.L110:
 1075              		.align	2
 1076              	.L109:
 1077 0040 00000000 		.word	.LANCHOR1
 1078 0044 00000000 		.word	k_current_task
 1079              		.cfi_endproc
 1080              	.LFE28:
 1082              		.section	.text.kernel_init,"ax",%progbits
 1083              		.align	1
 1084              		.global	kernel_init
 1085              		.syntax unified
 1086              		.thumb
 1087              		.thumb_func
 1088              		.fpu fpv4-sp-d16
 1090              	kernel_init:
 1091              	.LFB29:
 356:../../picokernel/k_kernel.c **** 
ARM GAS  /tmp/cc4fe6my.s 			page 37


 357:../../picokernel/k_kernel.c **** 
 358:../../picokernel/k_kernel.c **** k_status_t kernel_init(void)
 359:../../picokernel/k_kernel.c **** {
 1092              		.loc 1 359 0
 1093              		.cfi_startproc
 1094              		@ args = 0, pretend = 0, frame = 0
 1095              		@ frame_needed = 0, uses_anonymous_args = 0
 1096 0000 38B5     		push	{r3, r4, r5, lr}
 1097              	.LCFI9:
 1098              		.cfi_def_cfa_offset 16
 1099              		.cfi_offset 3, -16
 1100              		.cfi_offset 4, -12
 1101              		.cfi_offset 5, -8
 1102              		.cfi_offset 14, -4
 360:../../picokernel/k_kernel.c **** 	irq_lock_nest = 0;
 1103              		.loc 1 360 0
 1104 0002 0024     		movs	r4, #0
 1105 0004 1C4B     		ldr	r3, .L118
 1106 0006 1C60     		str	r4, [r3]
 361:../../picokernel/k_kernel.c **** 
 362:../../picokernel/k_kernel.c **** 	archtype_t key = port_irq_lock();
 1107              		.loc 1 362 0
 1108 0008 FFF7FEFF 		bl	port_irq_lock
 1109              	.LVL131:
 1110 000c 0546     		mov	r5, r0
 1111              	.LVL132:
 363:../../picokernel/k_kernel.c **** 
 364:../../picokernel/k_kernel.c **** 	/* no priority ready */
 365:../../picokernel/k_kernel.c **** 	k_work_list_init(&k_rdy_list);
 1112              		.loc 1 365 0
 1113 000e 1B48     		ldr	r0, .L118+4
 1114              	.LVL133:
 1115 0010 FFF7FEFF 		bl	k_work_list_init
 1116              	.LVL134:
 1117              	.LBB159:
 1118              	.LBB160:
 194:../../../uLipeRtosPico/picokernel/inc/k_list.h **** 	list->tail = (sys_dnode_t *)list;
 1119              		.loc 3 194 0
 1120 0014 1A4B     		ldr	r3, .L118+8
 1121 0016 1B60     		str	r3, [r3]
 195:../../../uLipeRtosPico/picokernel/inc/k_list.h **** }
 1122              		.loc 3 195 0
 1123 0018 5B60     		str	r3, [r3, #4]
 1124              	.LVL135:
 1125              	.LBE160:
 1126              	.LBE159:
 366:../../picokernel/k_kernel.c **** 
 367:../../picokernel/k_kernel.c **** 	/* init timed list */
 368:../../picokernel/k_kernel.c **** 	sys_dlist_init(&k_timed_list);
 369:../../picokernel/k_kernel.c **** 
 370:../../picokernel/k_kernel.c **** 	/* irq counter zeroed, default state */
 371:../../picokernel/k_kernel.c **** 	irq_counter = 0;
 1127              		.loc 1 371 0
 1128 001a 1A4B     		ldr	r3, .L118+12
 1129 001c 1C60     		str	r4, [r3]
 372:../../picokernel/k_kernel.c **** 
 373:../../picokernel/k_kernel.c **** 	/* current and hpt holding no task */
ARM GAS  /tmp/cc4fe6my.s 			page 38


 374:../../picokernel/k_kernel.c **** 	k_current_task = NULL;
 1130              		.loc 1 374 0
 1131 001e 1A4B     		ldr	r3, .L118+16
 1132 0020 1C60     		str	r4, [r3]
 375:../../picokernel/k_kernel.c **** 	k_high_prio_task = NULL;
 1133              		.loc 1 375 0
 1134 0022 1A4B     		ldr	r3, .L118+20
 1135 0024 1C60     		str	r4, [r3]
 376:../../picokernel/k_kernel.c **** 
 377:../../picokernel/k_kernel.c **** 	port_irq_unlock(key);
 1136              		.loc 1 377 0
 1137 0026 2846     		mov	r0, r5
 1138 0028 FFF7FEFF 		bl	port_irq_unlock
 1139              	.LVL136:
 378:../../picokernel/k_kernel.c **** 
 379:../../picokernel/k_kernel.c **** 	extern tcb_t *next_task_wake;
 380:../../picokernel/k_kernel.c **** 	extern uint32_t tick_count;
 381:../../picokernel/k_kernel.c **** 	extern ktimer_t *actual_timer;
 382:../../picokernel/k_kernel.c **** 
 383:../../picokernel/k_kernel.c **** 	wu_info.next_thread_wake = next_task_wake;
 1140              		.loc 1 383 0
 1141 002c 1849     		ldr	r1, .L118+24
 1142 002e 194B     		ldr	r3, .L118+28
 1143 0030 1B68     		ldr	r3, [r3]
 1144 0032 0B60     		str	r3, [r1]
 384:../../picokernel/k_kernel.c **** 	wu_info.next_timer = actual_timer;
 1145              		.loc 1 384 0
 1146 0034 184B     		ldr	r3, .L118+32
 1147 0036 1B68     		ldr	r3, [r3]
 1148 0038 4B60     		str	r3, [r1, #4]
 385:../../picokernel/k_kernel.c **** 	wu_info.tick_cntr = &tick_count;
 1149              		.loc 1 385 0
 1150 003a 184B     		ldr	r3, .L118+36
 1151 003c 8B60     		str	r3, [r1, #8]
 386:../../picokernel/k_kernel.c **** 
 387:../../picokernel/k_kernel.c **** 	/* creates the idle thread */
 388:../../picokernel/k_kernel.c **** 	k_status_t err = thread_create(&k_idle_thread,&wu_info, &idle_thread);
 1152              		.loc 1 388 0
 1153 003e 184A     		ldr	r2, .L118+40
 1154 0040 1848     		ldr	r0, .L118+44
 1155 0042 FFF7FEFF 		bl	thread_create
 1156              	.LVL137:
 1157              	.LBB161:
 1158              	.LBB162:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 1159              		.loc 2 128 0
 1160 0046 10B1     		cbz	r0, .L112
 1161              		.loc 2 129 0
 1162 0048 FFF7FEFF 		bl	port_set_break
 1163              	.LVL138:
 1164              	.L113:
 1165 004c FEE7     		b	.L113
 1166              	.LVL139:
 1167              	.L112:
 1168              	.LBE162:
 1169              	.LBE161:
 389:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(err == k_status_ok);
ARM GAS  /tmp/cc4fe6my.s 			page 39


 390:../../picokernel/k_kernel.c **** 
 391:../../picokernel/k_kernel.c **** #if(K_ENABLE_DYNAMIC_ALLOCATOR > 0)
 392:../../picokernel/k_kernel.c **** 	extern void k_heap_init(void);
 393:../../picokernel/k_kernel.c **** 	k_heap_init();
 394:../../picokernel/k_kernel.c **** #endif
 395:../../picokernel/k_kernel.c **** 
 396:../../picokernel/k_kernel.c **** 	k_make_not_ready(&idle_thread);
 1170              		.loc 1 396 0
 1171 004e 144C     		ldr	r4, .L118+40
 1172 0050 2046     		mov	r0, r4
 1173              	.LVL140:
 1174 0052 FFF7FEFF 		bl	k_make_not_ready
 1175              	.LVL141:
 397:../../picokernel/k_kernel.c **** 	idle_thread.thread_prio = K_IDLE_THREAD_PRIO;
 1176              		.loc 1 397 0
 1177 0056 FF23     		movs	r3, #255
 1178 0058 A373     		strb	r3, [r4, #14]
 398:../../picokernel/k_kernel.c **** 
 399:../../picokernel/k_kernel.c **** #if(K_ENABLE_TICKER > 0)
 400:../../picokernel/k_kernel.c **** 	err = thread_create(&timer_dispatcher,NULL, &timer_tcb);
 1179              		.loc 1 400 0
 1180 005a 134A     		ldr	r2, .L118+48
 1181 005c 0021     		movs	r1, #0
 1182 005e 1348     		ldr	r0, .L118+52
 1183 0060 FFF7FEFF 		bl	thread_create
 1184              	.LVL142:
 1185              	.LBB163:
 1186              	.LBB164:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 1187              		.loc 2 128 0
 1188 0064 20B9     		cbnz	r0, .L117
 1189              	.LVL143:
 1190              	.LBE164:
 1191              	.LBE163:
 401:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(err == k_status_ok);
 402:../../picokernel/k_kernel.c **** #endif
 403:../../picokernel/k_kernel.c **** 
 404:../../picokernel/k_kernel.c **** 	/* os configured and ready to be started */
 405:../../picokernel/k_kernel.c **** 	k_configured = true;
 1192              		.loc 1 405 0
 1193 0066 0122     		movs	r2, #1
 1194 0068 114B     		ldr	r3, .L118+56
 1195 006a 1A70     		strb	r2, [r3]
 406:../../picokernel/k_kernel.c **** 
 407:../../picokernel/k_kernel.c **** 	return(k_status_ok);
 408:../../picokernel/k_kernel.c **** }
 1196              		.loc 1 408 0
 1197 006c 0020     		movs	r0, #0
 1198              	.LVL144:
 1199 006e 38BD     		pop	{r3, r4, r5, pc}
 1200              	.LVL145:
 1201              	.L117:
 1202              	.LBB166:
 1203              	.LBB165:
 1204              		.loc 2 129 0
 1205 0070 FFF7FEFF 		bl	port_set_break
 1206              	.LVL146:
ARM GAS  /tmp/cc4fe6my.s 			page 40


 1207              	.L115:
 1208 0074 FEE7     		b	.L115
 1209              	.L119:
 1210 0076 00BF     		.align	2
 1211              	.L118:
 1212 0078 00000000 		.word	irq_lock_nest
 1213 007c 00000000 		.word	.LANCHOR2
 1214 0080 00000000 		.word	.LANCHOR4
 1215 0084 00000000 		.word	.LANCHOR3
 1216 0088 00000000 		.word	k_current_task
 1217 008c 00000000 		.word	k_high_prio_task
 1218 0090 00000000 		.word	.LANCHOR5
 1219 0094 00000000 		.word	next_task_wake
 1220 0098 00000000 		.word	actual_timer
 1221 009c 00000000 		.word	tick_count
 1222 00a0 00000000 		.word	.LANCHOR0
 1223 00a4 00000000 		.word	k_idle_thread
 1224 00a8 00000000 		.word	timer_tcb
 1225 00ac 00000000 		.word	timer_dispatcher
 1226 00b0 00000000 		.word	.LANCHOR6
 1227              	.LBE165:
 1228              	.LBE166:
 1229              		.cfi_endproc
 1230              	.LFE29:
 1232              		.section	.text.kernel_start,"ax",%progbits
 1233              		.align	1
 1234              		.global	kernel_start
 1235              		.syntax unified
 1236              		.thumb
 1237              		.thumb_func
 1238              		.fpu fpv4-sp-d16
 1240              	kernel_start:
 1241              	.LFB30:
 409:../../picokernel/k_kernel.c **** 
 410:../../picokernel/k_kernel.c **** k_status_t kernel_start(void)
 411:../../picokernel/k_kernel.c **** {
 1242              		.loc 1 411 0
 1243              		.cfi_startproc
 1244              		@ args = 0, pretend = 0, frame = 0
 1245              		@ frame_needed = 0, uses_anonymous_args = 0
 1246 0000 08B5     		push	{r3, lr}
 1247              	.LCFI10:
 1248              		.cfi_def_cfa_offset 8
 1249              		.cfi_offset 3, -8
 1250              		.cfi_offset 14, -4
 412:../../picokernel/k_kernel.c **** 	if(!k_configured)
 1251              		.loc 1 412 0
 1252 0002 094B     		ldr	r3, .L127
 1253 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1254 0006 0BB9     		cbnz	r3, .L125
 1255              	.L121:
 413:../../picokernel/k_kernel.c **** 		/* kernel must be configured before start */
 414:../../picokernel/k_kernel.c **** 		goto cleanup;
 415:../../picokernel/k_kernel.c **** 
 416:../../picokernel/k_kernel.c **** 	/* init architecture stuff */
 417:../../picokernel/k_kernel.c **** 	port_init_machine();
 418:../../picokernel/k_kernel.c **** 
ARM GAS  /tmp/cc4fe6my.s 			page 41


 419:../../picokernel/k_kernel.c **** 	/* gets the first task to run */
 420:../../picokernel/k_kernel.c **** 	k_high_prio_task = k_sched(&k_rdy_list);
 421:../../picokernel/k_kernel.c **** 
 422:../../picokernel/k_kernel.c **** 	ULIPE_ASSERT(k_high_prio_task != NULL);
 423:../../picokernel/k_kernel.c **** 
 424:../../picokernel/k_kernel.c **** 	/* start kernel (this function will never return) */
 425:../../picokernel/k_kernel.c **** 	port_start_kernel();
 426:../../picokernel/k_kernel.c **** 
 427:../../picokernel/k_kernel.c **** cleanup:
 428:../../picokernel/k_kernel.c **** 	return(k_status_error);
 429:../../picokernel/k_kernel.c **** }
 1256              		.loc 1 429 0
 1257 0008 0120     		movs	r0, #1
 1258 000a 08BD     		pop	{r3, pc}
 1259              	.L125:
 417:../../picokernel/k_kernel.c **** 
 1260              		.loc 1 417 0
 1261 000c FFF7FEFF 		bl	port_init_machine
 1262              	.LVL147:
 420:../../picokernel/k_kernel.c **** 
 1263              		.loc 1 420 0
 1264 0010 0648     		ldr	r0, .L127+4
 1265 0012 FFF7FEFF 		bl	k_sched
 1266              	.LVL148:
 1267 0016 064B     		ldr	r3, .L127+8
 1268 0018 1860     		str	r0, [r3]
 1269              	.LVL149:
 1270              	.LBB167:
 1271              	.LBB168:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 1272              		.loc 2 128 0
 1273 001a 10B1     		cbz	r0, .L126
 1274              	.LVL150:
 1275              	.LBE168:
 1276              	.LBE167:
 425:../../picokernel/k_kernel.c **** 
 1277              		.loc 1 425 0
 1278 001c FFF7FEFF 		bl	port_start_kernel
 1279              	.LVL151:
 1280 0020 F2E7     		b	.L121
 1281              	.LVL152:
 1282              	.L126:
 1283              	.LBB170:
 1284              	.LBB169:
 1285              		.loc 2 129 0
 1286 0022 FFF7FEFF 		bl	port_set_break
 1287              	.LVL153:
 1288              	.L123:
 1289 0026 FEE7     		b	.L123
 1290              	.L128:
 1291              		.align	2
 1292              	.L127:
 1293 0028 00000000 		.word	.LANCHOR6
 1294 002c 00000000 		.word	.LANCHOR2
 1295 0030 00000000 		.word	k_high_prio_task
 1296              	.LBE169:
 1297              	.LBE170:
ARM GAS  /tmp/cc4fe6my.s 			page 42


 1298              		.cfi_endproc
 1299              	.LFE30:
 1301              		.section	.text.kernel_irq_in,"ax",%progbits
 1302              		.align	1
 1303              		.global	kernel_irq_in
 1304              		.syntax unified
 1305              		.thumb
 1306              		.thumb_func
 1307              		.fpu fpv4-sp-d16
 1309              	kernel_irq_in:
 1310              	.LFB31:
 430:../../picokernel/k_kernel.c **** 
 431:../../picokernel/k_kernel.c **** void kernel_irq_in(void)
 432:../../picokernel/k_kernel.c **** {
 1311              		.loc 1 432 0
 1312              		.cfi_startproc
 1313              		@ args = 0, pretend = 0, frame = 0
 1314              		@ frame_needed = 0, uses_anonymous_args = 0
 1315 0000 08B5     		push	{r3, lr}
 1316              	.LCFI11:
 1317              		.cfi_def_cfa_offset 8
 1318              		.cfi_offset 3, -8
 1319              		.cfi_offset 14, -4
 433:../../picokernel/k_kernel.c **** 
 434:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 435:../../picokernel/k_kernel.c **** 	if(k_running) {
 1320              		.loc 1 435 0
 1321 0002 144B     		ldr	r3, .L137
 1322 0004 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 1323 0006 59B1     		cbz	r1, .L130
 436:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 1324              		.loc 1 436 0
 1325 0008 134B     		ldr	r3, .L137+4
 1326 000a 1A68     		ldr	r2, [r3]
 1327 000c 1368     		ldr	r3, [r2]
 1328 000e 5068     		ldr	r0, [r2, #4]
 1329 0010 1B1A     		subs	r3, r3, r0
 1330 0012 9B10     		asrs	r3, r3, #2
 1331 0014 9360     		str	r3, [r2, #8]
 437:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 438:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 1332              		.loc 1 438 0
 1333 0016 1269     		ldr	r2, [r2, #16]
 1334 0018 9200     		lsls	r2, r2, #2
 1335              	.LVL154:
 1336              	.LBB171:
 1337              	.LBB172:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
 1338              		.loc 2 128 0
 1339 001a B2EB830F 		cmp	r2, r3, lsl #2
 1340 001e 01D3     		bcc	.L135
 1341              	.LVL155:
 1342              	.L130:
 1343              	.LBE172:
 1344              	.LBE171:
 439:../../picokernel/k_kernel.c **** 	}
 440:../../picokernel/k_kernel.c **** #endif
ARM GAS  /tmp/cc4fe6my.s 			page 43


 441:../../picokernel/k_kernel.c **** 
 442:../../picokernel/k_kernel.c **** 	/* this function only can be called if os is executing  and from an isr*/
 443:../../picokernel/k_kernel.c **** 	if(!k_running)
 1345              		.loc 1 443 0
 1346 0020 19B9     		cbnz	r1, .L136
 1347              	.L129:
 1348 0022 08BD     		pop	{r3, pc}
 1349              	.LVL156:
 1350              	.L135:
 1351              	.LBB174:
 1352              	.LBB173:
 1353              		.loc 2 129 0
 1354 0024 FFF7FEFF 		bl	port_set_break
 1355              	.LVL157:
 1356              	.L131:
 1357 0028 FEE7     		b	.L131
 1358              	.L136:
 1359              	.LBE173:
 1360              	.LBE174:
 444:../../picokernel/k_kernel.c **** 		return;
 445:../../picokernel/k_kernel.c **** #if(ARCH_TYPE_AVR_TINY > 0)
 446:../../picokernel/k_kernel.c **** 	(void)0;
 447:../../picokernel/k_kernel.c **** #else 		
 448:../../picokernel/k_kernel.c **** 	if(!port_from_isr())
 1361              		.loc 1 448 0
 1362 002a FFF7FEFF 		bl	port_from_isr
 1363              	.LVL158:
 1364 002e 0028     		cmp	r0, #0
 1365 0030 F7D0     		beq	.L129
 449:../../picokernel/k_kernel.c **** 		return;
 450:../../picokernel/k_kernel.c **** #endif
 451:../../picokernel/k_kernel.c **** 
 452:../../picokernel/k_kernel.c **** 	if(irq_counter < (archtype_t)0xFFFFFFFF)
 1366              		.loc 1 452 0
 1367 0032 0A4B     		ldr	r3, .L137+8
 1368 0034 1B68     		ldr	r3, [r3]
 1369 0036 B3F1FF3F 		cmp	r3, #-1
 1370 003a 02D0     		beq	.L133
 453:../../picokernel/k_kernel.c **** 		irq_counter++;
 1371              		.loc 1 453 0
 1372 003c 0133     		adds	r3, r3, #1
 1373 003e 074A     		ldr	r2, .L137+8
 1374 0040 1360     		str	r3, [r2]
 1375              	.L133:
 454:../../picokernel/k_kernel.c **** 
 455:../../picokernel/k_kernel.c **** 	if(irq_lock_nest < (archtype_t)0xFFFFFFFF)
 1376              		.loc 1 455 0
 1377 0042 074B     		ldr	r3, .L137+12
 1378 0044 1B68     		ldr	r3, [r3]
 1379 0046 B3F1FF3F 		cmp	r3, #-1
 1380 004a EAD0     		beq	.L129
 456:../../picokernel/k_kernel.c **** 		irq_lock_nest++;
 1381              		.loc 1 456 0
 1382 004c 0133     		adds	r3, r3, #1
 1383 004e 044A     		ldr	r2, .L137+12
 1384 0050 1360     		str	r3, [r2]
 1385 0052 E6E7     		b	.L129
ARM GAS  /tmp/cc4fe6my.s 			page 44


 1386              	.L138:
 1387              		.align	2
 1388              	.L137:
 1389 0054 00000000 		.word	.LANCHOR1
 1390 0058 00000000 		.word	k_current_task
 1391 005c 00000000 		.word	.LANCHOR3
 1392 0060 00000000 		.word	irq_lock_nest
 1393              		.cfi_endproc
 1394              	.LFE31:
 1396              		.section	.text.kernel_irq_out,"ax",%progbits
 1397              		.align	1
 1398              		.global	kernel_irq_out
 1399              		.syntax unified
 1400              		.thumb
 1401              		.thumb_func
 1402              		.fpu fpv4-sp-d16
 1404              	kernel_irq_out:
 1405              	.LFB32:
 457:../../picokernel/k_kernel.c **** 
 458:../../picokernel/k_kernel.c **** }
 459:../../picokernel/k_kernel.c **** 
 460:../../picokernel/k_kernel.c **** void kernel_irq_out(void)
 461:../../picokernel/k_kernel.c **** {
 1406              		.loc 1 461 0
 1407              		.cfi_startproc
 1408              		@ args = 0, pretend = 0, frame = 0
 1409              		@ frame_needed = 0, uses_anonymous_args = 0
 1410 0000 08B5     		push	{r3, lr}
 1411              	.LCFI12:
 1412              		.cfi_def_cfa_offset 8
 1413              		.cfi_offset 3, -8
 1414              		.cfi_offset 14, -4
 462:../../picokernel/k_kernel.c **** 
 463:../../picokernel/k_kernel.c **** #if K_DEBUG > 0
 464:../../picokernel/k_kernel.c **** 	if(k_running) {
 1415              		.loc 1 464 0
 1416 0002 154B     		ldr	r3, .L147
 1417 0004 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 1418 0006 59B1     		cbz	r1, .L140
 465:../../picokernel/k_kernel.c **** 		k_current_task->stk_usage = (k_current_task->stack_top - k_current_task->stack_base);
 1419              		.loc 1 465 0
 1420 0008 144B     		ldr	r3, .L147+4
 1421 000a 1A68     		ldr	r2, [r3]
 1422 000c 1368     		ldr	r3, [r2]
 1423 000e 5068     		ldr	r0, [r2, #4]
 1424 0010 1B1A     		subs	r3, r3, r0
 1425 0012 9B10     		asrs	r3, r3, #2
 1426 0014 9360     		str	r3, [r2, #8]
 466:../../picokernel/k_kernel.c **** 		/* stack monitor used during debug */
 467:../../picokernel/k_kernel.c **** 		ULIPE_ASSERT( k_current_task->stk_usage * sizeof(archtype_t) <=  k_current_task->stack_size * siz
 1427              		.loc 1 467 0
 1428 0016 1269     		ldr	r2, [r2, #16]
 1429 0018 9200     		lsls	r2, r2, #2
 1430              	.LVL159:
 1431              	.LBB175:
 1432              	.LBB176:
 128:../../../uLipeRtosPico/ulipe_rtos_pico.h **** 		port_set_break();
ARM GAS  /tmp/cc4fe6my.s 			page 45


 1433              		.loc 2 128 0
 1434 001a B2EB830F 		cmp	r2, r3, lsl #2
 1435 001e 01D3     		bcc	.L145
 1436              	.LVL160:
 1437              	.L140:
 1438              	.LBE176:
 1439              	.LBE175:
 468:../../picokernel/k_kernel.c **** 	}
 469:../../picokernel/k_kernel.c **** #endif
 470:../../picokernel/k_kernel.c **** 
 471:../../picokernel/k_kernel.c **** 	/* this function only can be called if os is executing  and from an isr*/
 472:../../picokernel/k_kernel.c **** 	if(!k_running)
 1440              		.loc 1 472 0
 1441 0020 19B9     		cbnz	r1, .L146
 1442              	.L139:
 1443 0022 08BD     		pop	{r3, pc}
 1444              	.LVL161:
 1445              	.L145:
 1446              	.LBB178:
 1447              	.LBB177:
 1448              		.loc 2 129 0
 1449 0024 FFF7FEFF 		bl	port_set_break
 1450              	.LVL162:
 1451              	.L141:
 1452 0028 FEE7     		b	.L141
 1453              	.L146:
 1454              	.LBE177:
 1455              	.LBE178:
 473:../../picokernel/k_kernel.c **** 		return;
 474:../../picokernel/k_kernel.c **** 
 475:../../picokernel/k_kernel.c **** 	if(!port_from_isr())
 1456              		.loc 1 475 0
 1457 002a FFF7FEFF 		bl	port_from_isr
 1458              	.LVL163:
 1459 002e 0028     		cmp	r0, #0
 1460 0030 F7D0     		beq	.L139
 476:../../picokernel/k_kernel.c **** 		return;
 477:../../picokernel/k_kernel.c **** 
 478:../../picokernel/k_kernel.c **** 	if(irq_lock_nest > (archtype_t)0)
 1461              		.loc 1 478 0
 1462 0032 0B4B     		ldr	r3, .L147+8
 1463 0034 1B68     		ldr	r3, [r3]
 1464 0036 13B1     		cbz	r3, .L143
 479:../../picokernel/k_kernel.c **** 		irq_lock_nest--;
 1465              		.loc 1 479 0
 1466 0038 013B     		subs	r3, r3, #1
 1467 003a 094A     		ldr	r2, .L147+8
 1468 003c 1360     		str	r3, [r2]
 1469              	.L143:
 480:../../picokernel/k_kernel.c **** 
 481:../../picokernel/k_kernel.c **** 
 482:../../picokernel/k_kernel.c **** 	if(irq_counter > (archtype_t)0) {
 1470              		.loc 1 482 0
 1471 003e 094B     		ldr	r3, .L147+12
 1472 0040 1B68     		ldr	r3, [r3]
 1473 0042 002B     		cmp	r3, #0
 1474 0044 EDD0     		beq	.L139
ARM GAS  /tmp/cc4fe6my.s 			page 46


 483:../../picokernel/k_kernel.c **** 		irq_counter--;
 1475              		.loc 1 483 0
 1476 0046 013B     		subs	r3, r3, #1
 1477 0048 064A     		ldr	r2, .L147+12
 1478 004a 1360     		str	r3, [r2]
 484:../../picokernel/k_kernel.c **** 		/* all isrs attended, perform a system reeschedule */
 485:../../picokernel/k_kernel.c **** 		if(!irq_counter)
 1479              		.loc 1 485 0
 1480 004c 002B     		cmp	r3, #0
 1481 004e E8D1     		bne	.L139
 486:../../picokernel/k_kernel.c **** 			k_sched_and_swap();
 1482              		.loc 1 486 0
 1483 0050 FFF7FEFF 		bl	k_sched_and_swap
 1484              	.LVL164:
 1485 0054 E5E7     		b	.L139
 1486              	.L148:
 1487 0056 00BF     		.align	2
 1488              	.L147:
 1489 0058 00000000 		.word	.LANCHOR1
 1490 005c 00000000 		.word	k_current_task
 1491 0060 00000000 		.word	irq_lock_nest
 1492 0064 00000000 		.word	.LANCHOR3
 1493              		.cfi_endproc
 1494              	.LFE32:
 1496              		.global	irq_nesting
 1497              		.comm	k_high_prio_task,4,4
 1498              		.comm	k_current_task,4,4
 1499              		.global	k_running
 1500              		.comm	irq_lock_nest,4,4
 1501              		.global	idle_thread
 1502              		.section	.bss.irq_counter,"aw",%nobits
 1503              		.align	2
 1504              		.set	.LANCHOR3,. + 0
 1507              	irq_counter:
 1508 0000 00000000 		.space	4
 1509              		.section	.bss.irq_nesting,"aw",%nobits
 1510              		.align	2
 1513              	irq_nesting:
 1514 0000 00000000 		.space	4
 1515              		.section	.bss.k_configured,"aw",%nobits
 1516              		.set	.LANCHOR6,. + 0
 1519              	k_configured:
 1520 0000 00       		.space	1
 1521              		.section	.bss.k_rdy_list,"aw",%nobits
 1522              		.align	2
 1523              		.set	.LANCHOR2,. + 0
 1526              	k_rdy_list:
 1527 0000 00000000 		.space	260
 1527      00000000 
 1527      00000000 
 1527      00000000 
 1527      00000000 
 1528              		.section	.bss.k_running,"aw",%nobits
 1529              		.set	.LANCHOR1,. + 0
 1532              	k_running:
 1533 0000 00       		.space	1
 1534              		.section	.bss.k_timed_list,"aw",%nobits
ARM GAS  /tmp/cc4fe6my.s 			page 47


 1535              		.align	2
 1536              		.set	.LANCHOR4,. + 0
 1539              	k_timed_list:
 1540 0000 00000000 		.space	8
 1540      00000000 
 1541              		.section	.bss.stack_idle_thread,"aw",%nobits
 1542              		.align	2
 1545              	stack_idle_thread:
 1546 0000 00000000 		.space	512
 1546      00000000 
 1546      00000000 
 1546      00000000 
 1546      00000000 
 1547              		.section	.bss.wu_info,"aw",%nobits
 1548              		.align	2
 1549              		.set	.LANCHOR5,. + 0
 1552              	wu_info:
 1553 0000 00000000 		.space	12
 1553      00000000 
 1553      00000000 
 1554              		.section	.data.idle_thread,"aw",%progbits
 1555              		.align	2
 1556              		.set	.LANCHOR0,. + 0
 1559              	idle_thread:
 1560 0000 00000000 		.space	4
 1561 0004 00000000 		.word	stack_idle_thread
 1562 0008 00000000 		.space	4
 1563 000c 0000     		.short	0
 1564 000e 00       		.byte	0
 1565 000f 00       		.byte	0
 1566 0010 80000000 		.word	128
 1567 0014 00000000 		.word	0
 1568 0018 00000000 		.space	20
 1568      00000000 
 1568      00000000 
 1568      00000000 
 1568      00000000 
 1569              		.text
 1570              	.Letext0:
 1571              		.file 4 "/home/venturus/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/machine/_default_
 1572              		.file 5 "/home/venturus/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/_stdint.h"
 1573              		.file 6 "/home/venturus/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/lock.h"
 1574              		.file 7 "/home/venturus/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/_types.h"
 1575              		.file 8 "/home/venturus/gcc-arm-none-eabi-6-2017-q2-update/lib/gcc/arm-none-eabi/6.3.1/include/std
 1576              		.file 9 "/home/venturus/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/reent.h"
 1577              		.file 10 "../../../uLipeRtosPico/include/picokernel/k_thread.h"
 1578              		.file 11 "../../../uLipeRtosPico/include/picokernel/k_kernel.h"
 1579              		.file 12 "../../../uLipeRtosPico/include/picokernel/k_raw_timer.h"
 1580              		.file 13 "../../../uLipeRtosPico/include/picokernel/k_port.h"
ARM GAS  /tmp/cc4fe6my.s 			page 48


DEFINED SYMBOLS
                            *ABS*:0000000000000000 k_kernel.c
     /tmp/cc4fe6my.s:18     .text.k_idle_thread:0000000000000000 $t
     /tmp/cc4fe6my.s:24     .text.k_idle_thread:0000000000000000 k_idle_thread
     /tmp/cc4fe6my.s:61     .text.k_sched:0000000000000000 $t
     /tmp/cc4fe6my.s:67     .text.k_sched:0000000000000000 k_sched
     /tmp/cc4fe6my.s:196    .text.k_sched:000000000000005c $d
                            *COM*:0000000000000004 k_current_task
     /tmp/cc4fe6my.s:203    .text.k_pend_obj:0000000000000000 $t
     /tmp/cc4fe6my.s:210    .text.k_pend_obj:0000000000000000 k_pend_obj
     /tmp/cc4fe6my.s:330    .text.k_pend_obj:0000000000000064 $d
     /tmp/cc4fe6my.s:338    .text.k_unpend_obj:0000000000000000 $t
     /tmp/cc4fe6my.s:345    .text.k_unpend_obj:0000000000000000 k_unpend_obj
     /tmp/cc4fe6my.s:474    .text.k_unpend_obj:000000000000006c $d
     /tmp/cc4fe6my.s:481    .text.k_make_ready:0000000000000000 $t
     /tmp/cc4fe6my.s:488    .text.k_make_ready:0000000000000000 k_make_ready
     /tmp/cc4fe6my.s:595    .text.k_make_ready:0000000000000060 $d
     /tmp/cc4fe6my.s:604    .text.k_make_not_ready:0000000000000000 $t
     /tmp/cc4fe6my.s:611    .text.k_make_not_ready:0000000000000000 k_make_not_ready
     /tmp/cc4fe6my.s:725    .text.k_make_not_ready:0000000000000064 $d
     /tmp/cc4fe6my.s:732    .text.k_yield:0000000000000000 $t
     /tmp/cc4fe6my.s:739    .text.k_yield:0000000000000000 k_yield
     /tmp/cc4fe6my.s:857    .text.k_yield:0000000000000060 $d
     /tmp/cc4fe6my.s:864    .text.k_sched_and_swap:0000000000000000 $t
     /tmp/cc4fe6my.s:871    .text.k_sched_and_swap:0000000000000000 k_sched_and_swap
     /tmp/cc4fe6my.s:972    .text.k_sched_and_swap:0000000000000064 $d
                            *COM*:0000000000000004 k_high_prio_task
     /tmp/cc4fe6my.s:982    .text.k_work_list_init:0000000000000000 $t
     /tmp/cc4fe6my.s:989    .text.k_work_list_init:0000000000000000 k_work_list_init
     /tmp/cc4fe6my.s:1077   .text.k_work_list_init:0000000000000040 $d
     /tmp/cc4fe6my.s:1083   .text.kernel_init:0000000000000000 $t
     /tmp/cc4fe6my.s:1090   .text.kernel_init:0000000000000000 kernel_init
     /tmp/cc4fe6my.s:1212   .text.kernel_init:0000000000000078 $d
                            *COM*:0000000000000004 irq_lock_nest
     /tmp/cc4fe6my.s:1233   .text.kernel_start:0000000000000000 $t
     /tmp/cc4fe6my.s:1240   .text.kernel_start:0000000000000000 kernel_start
     /tmp/cc4fe6my.s:1293   .text.kernel_start:0000000000000028 $d
     /tmp/cc4fe6my.s:1302   .text.kernel_irq_in:0000000000000000 $t
     /tmp/cc4fe6my.s:1309   .text.kernel_irq_in:0000000000000000 kernel_irq_in
     /tmp/cc4fe6my.s:1389   .text.kernel_irq_in:0000000000000054 $d
     /tmp/cc4fe6my.s:1397   .text.kernel_irq_out:0000000000000000 $t
     /tmp/cc4fe6my.s:1404   .text.kernel_irq_out:0000000000000000 kernel_irq_out
     /tmp/cc4fe6my.s:1489   .text.kernel_irq_out:0000000000000058 $d
     /tmp/cc4fe6my.s:1513   .bss.irq_nesting:0000000000000000 irq_nesting
     /tmp/cc4fe6my.s:1532   .bss.k_running:0000000000000000 k_running
     /tmp/cc4fe6my.s:1559   .data.idle_thread:0000000000000000 idle_thread
     /tmp/cc4fe6my.s:1503   .bss.irq_counter:0000000000000000 $d
     /tmp/cc4fe6my.s:1507   .bss.irq_counter:0000000000000000 irq_counter
     /tmp/cc4fe6my.s:1510   .bss.irq_nesting:0000000000000000 $d
     /tmp/cc4fe6my.s:1519   .bss.k_configured:0000000000000000 k_configured
     /tmp/cc4fe6my.s:1520   .bss.k_configured:0000000000000000 $d
     /tmp/cc4fe6my.s:1522   .bss.k_rdy_list:0000000000000000 $d
     /tmp/cc4fe6my.s:1526   .bss.k_rdy_list:0000000000000000 k_rdy_list
     /tmp/cc4fe6my.s:1533   .bss.k_running:0000000000000000 $d
     /tmp/cc4fe6my.s:1535   .bss.k_timed_list:0000000000000000 $d
     /tmp/cc4fe6my.s:1539   .bss.k_timed_list:0000000000000000 k_timed_list
     /tmp/cc4fe6my.s:1542   .bss.stack_idle_thread:0000000000000000 $d
ARM GAS  /tmp/cc4fe6my.s 			page 49


     /tmp/cc4fe6my.s:1545   .bss.stack_idle_thread:0000000000000000 stack_idle_thread
     /tmp/cc4fe6my.s:1548   .bss.wu_info:0000000000000000 $d
     /tmp/cc4fe6my.s:1552   .bss.wu_info:0000000000000000 wu_info
     /tmp/cc4fe6my.s:1555   .data.idle_thread:0000000000000000 $d
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
port_set_break
port_bit_fs_scan
port_swap_req
port_irq_lock
port_irq_unlock
thread_create
next_task_wake
actual_timer
tick_count
timer_tcb
timer_dispatcher
port_init_machine
port_start_kernel
port_from_isr
